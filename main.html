<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment System</title>
    <link rel="preconnect" href="https://script.google.com">
    <link rel="preconnect" href="https://api.telegram.org">
<style>
    :root {
    --primary-bg: linear-gradient(135deg, #042F28 0%, #0A5C4A 100%);
    --accent-color: #D0E41E;
    --text-color: white;
    --secondary-text: #ccc;
    --input-bg: rgba(255, 255, 255, 0.9);
    --input-border: #34495e;
    --card-bg: rgba(255, 255, 255, 0.1);
    --border-color: rgba(255, 255, 255, 0.2);
    --loading-green: #0A5C4A;
    }

    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        font-family: 'Arial', sans-serif;
    }

    body {
        background: var(--primary-bg);
        color: var(--text-color);
        min-height: 100vh;
        padding: 20px;
        direction: ltr;
        transition: margin-right 0.3s ease;
    }

    body.console-active {
        margin-right: 350px;
    }

    body[dir="rtl"] {
        direction: rtl;
        text-align: right;
    }

    body[dir="rtl"].console-active {
        margin-right: 0;
        margin-left: 350px;
    }

    /* –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù */
    #loadingScreen {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: var(--primary-bg);
        display: flex;
        flex-direction: column;
        justify-content: center;
        align-items: center;
        z-index: 9999;
        backdrop-filter: blur(10px);
    }

    .loading-container {
        text-align: center;
        animation: fadeIn 0.5s ease;
    }

    .logo-spin {
        font-size: 64px;
        font-weight: 900;
        margin-bottom: 30px;
        display: flex;
        gap: 5px;
        justify-content: center;
        align-items: center;
    }

    .spin-letter {
        font-size: 64px;
        font-weight: 900;
        color: white;
        display: inline-block;
        position: relative;
    }

    .spin-letter:nth-child(1) { animation: spinLetter1 2s ease-in-out infinite; }
    .spin-letter:nth-child(2) { animation: spinLetter2 2s ease-in-out infinite 0.2s; }
    .spin-letter:nth-child(3) { animation: spinLetter3 2s ease-in-out infinite 0.4s; }
    .spin-letter:nth-child(4) { animation: spinLetter4 2s ease-in-out infinite 0.6s; }

    @keyframes spinLetter1 {
        0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
        50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
    }

    @keyframes spinLetter2 {
        0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
        50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
    }

    @keyframes spinLetter3 {
        0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
        50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
    }

    @keyframes spinLetter4 {
        0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
        50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
    }

    .better-text {
        font-size: 64px;
        font-weight: 900;
        color: var(--loading-green);
        display: inline-block;
        margin-left: 10px;
    }

    .loading-subtitle {
        margin-top: 20px;
        color: var(--secondary-text);
        font-size: 16px;
    }

    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* –ö–û–ù–°–û–õ–¨ –î–ï–ë–ê–ì–ê */
    #debugConsole {
        position: fixed;
        top: 0;
        right: 0;
        width: 350px;
        height: 100vh;
        background: rgba(0, 0, 0, 0.95);
        color: #00ff00;
        font-family: 'Courier New', monospace;
        font-size: 12px;
        overflow-y: auto;
        z-index: 9998;
        border-left: 2px solid var(--accent-color);
        display: none;
        padding: 10px;
        box-shadow: -5px 0 15px rgba(0,0,0,0.5);
    }

    body[dir="rtl"] #debugConsole {
        right: auto;
        left: 0;
        border-left: none;
        border-right: 2px solid var(--accent-color);
        box-shadow: 5px 0 15px rgba(0,0,0,0.5);
    }

    .console-header {
        display: flex;
        justify-content: space-between;
        padding: 5px 10px;
        background: rgba(0, 0, 0, 0.7);
        border-bottom: 1px solid #333;
        margin-bottom: 5px;
    }

    .console-title {
        color: var(--accent-color);
        font-weight: bold;
    }

    .console-close {
        color: #ff5555;
        cursor: pointer;
    }

    .log-entry {
        padding: 2px 5px;
        border-bottom: 1px solid #222;
        word-break: break-all;
    }

    .log-time {
        color: #888;
        margin-right: 10px;
    }

    .log-info {
        color: #4af;
    }

    .log-error {
        color: #f44;
    }

    .log-success {
        color: #4f4;
    }

    .log-warning {
        color: #ff4;
    }

    .container {
    max-width: 500px;
    margin: 0 auto;
    background: var(--card-bg);
    border-radius: 15px;
    padding: 20px;
    backdrop-filter: blur(10px);
    border: 1px solid var(--border-color);
    opacity: 0;
    transform: translateY(20px);
    transition: opacity 0.5s, transform 0.5s;
    display: block;
    z-index: 10 !important;
    position: relative !important;    
    }

    .container.loaded {
    opacity: 1;
    transform: translateY(0);
    }

    /* –Ø–ó–´–ö–û–í–û–ô –ü–ï–†–ï–ö–õ–Æ–ß–ê–¢–ï–õ–¨ */
    .language-selector {
        position: absolute;
        top: 20px;
        right: 20px;
        display: flex;
        gap: 5px;
        z-index: 100;
    }

    body[dir="rtl"] .language-selector {
        right: auto;
        left: 20px;
    }

    .lang-btn {
        padding: 6px 12px;
        background: rgba(255, 255, 255, 0.1);
        border: 1px solid var(--accent-color);
        color: var(--accent-color);
        border-radius: 5px;
        cursor: pointer;
        font-size: 12px;
        transition: all 0.3s;
    }

    .lang-btn:hover, .lang-btn.active {
        background: var(--accent-color);
        color: #2c3e50;
    }

    /* –•–ï–î–ï–† */
    .header {
        text-align: center;
        margin-bottom: 30px;
        padding-top: 10px;
    }

    .logo {
        font-size: 28px;
        font-weight: bold;
        color: var(--accent-color);
        margin-bottom: 10px;
    }

    .subtitle {
        color: var(--secondary-text);
        font-size: 14px;
    }

    /* –í–ö–õ–ê–î–ö–ò */
    .tab-container {
        display: flex;
        margin-bottom: 25px;
        background: rgba(255,255,255,0.1);
        border-radius: 12px;
        padding: 6px;
        border: 1px solid var(--border-color);
    }

    .tab {
        flex: 1;
        padding: 12px;
        text-align: center;
        cursor: pointer;
        border-radius: 8px;
        transition: all 0.3s ease;
        font-weight: bold;
        color: var(--secondary-text);
    }

    .tab.active {
        background: var(--accent-color);
        color: #2c3e50;
        box-shadow: 0 4px 12px rgba(208, 228, 30, 0.3);
    }

    /* –û–ë–õ–ê–°–¢–¨ –ö–û–ù–¢–ï–ù–¢–ê */
    .content-area {
        position: relative;
        min-height: 450px;
    }

    .tab-content {
        display: none;
        opacity: 0;
        transform: translateY(10px);
        transition: opacity 0.3s, transform 0.3s;
    }

    .tab-content.active {
        display: block;
        opacity: 1;
        transform: translateY(0);
    }

    /* –§–û–†–ú–´ */
    .form-group {
        margin-bottom: 20px;
        position: relative;
    }

    .form-label {
        display: flex;
        align-items: center;
        margin-bottom: 8px;
        font-weight: bold;
        color: var(--accent-color);
    }

    .info-icon {
        margin-left: 8px;
        color: var(--secondary-text);
        cursor: help;
        font-size: 16px;
        width: 20px;
        height: 20px;
        border-radius: 50%;
        border: 1px solid var(--secondary-text);
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 12px;
    }

    body[dir="rtl"] .info-icon {
        margin-left: 0;
        margin-right: 8px;
    }

    input, select {
        width: 100%;
        padding: 12px;
        border: 2px solid var(--input-border);
        border-radius: 8px;
        background: var(--input-bg);
        color: #2c3e50;
        font-size: 16px;
        transition: all 0.3s ease;
    }

    input:focus, select:focus {
        outline: none;
        border-color: var(--accent-color);
        background: white;
    }

    .form-hint {
        font-size: 13px;
        color: var(--secondary-text);
        margin-top: 6px;
        display: flex;
        align-items: center;
        gap: 5px;
    }

    /* –ú–ï–¢–û–î–´ –û–ü–õ–ê–¢–´ */
    .wallet-type-selector {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 10px;
        margin: 15px 0;
    }

    .wallet-type-btn {
        padding: 12px;
        background: rgba(255,255,255,0.1);
        border: 2px solid var(--input-border);
        border-radius: 8px;
        color: var(--text-color);
        cursor: pointer;
        text-align: center;
        transition: all 0.3s ease;
        font-size: 14px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
    }

    .wallet-type-btn.active {
        border-color: var(--accent-color);
        background: rgba(208, 228, 30, 0.2);
        color: var(--accent-color);
    }

    /* –ö–ù–û–ü–ö–ò */
    .btn {
        width: 100%;
        padding: 15px;
        background: var(--accent-color);
        color: #2c3e50;
        border: none;
        border-radius: 8px;
        font-size: 18px;
        font-weight: bold;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 10px;
    }

    .btn:hover {
        background: #b8cc1a;
        transform: translateY(-2px);
    }

    .btn:active {
        transform: translateY(0);
    }

    .btn:disabled {
        background: #7f8c8d;
        cursor: not-allowed;
        transform: none;
    }

    /* –ü–û–ü–ê–ü –†–ï–ó–£–õ–¨–¢–ê–¢–ê –î–ï–ü–û–ó–ò–¢–ê */
    .popup-overlay {
        display: none;
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.7);
        z-index: 999;
        backdrop-filter: blur(5px);
    }

    .popup-overlay.active {
        display: block;
    }

         /* –ü–û–ü–ê–ü –†–ï–ó–£–õ–¨–¢–ê–¢–ê –î–ï–ü–û–ó–ò–¢–ê */
    .deposit-popup {
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--card-bg);
        border: 2px solid var(--accent-color);
        border-radius: 15px;
        padding: 25px;
        z-index: 1000;
        width: 90%;
        max-width: 450px;
        max-height: 90vh;
        overflow-y: auto;
        backdrop-filter: blur(20px);
        display: none;
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
        box-sizing: border-box;
    }

    .deposit-popup.active {
        display: flex;
        flex-direction: column;
        animation: popupAppear 0.3s ease-out;
    }

    .popup-header {
        text-align: center;
        margin-bottom: 20px;
        flex-shrink: 0;
    }

    .popup-icon {
        font-size: 40px;
        margin-bottom: 10px;
    }

    .popup-title {
        font-size: 24px;
        font-weight: bold;
        color: var(--accent-color);
        margin-bottom: 8px;
    }

    .popup-subtitle {
        color: var(--secondary-text);
        font-size: 14px;
    }

    .amount-display {
        font-size: 36px;
        font-weight: 800;
        text-align: center;
        color: var(--accent-color);
        margin: 15px 0;
        padding: 20px;
        background: rgba(208, 228, 30, 0.15);
        border-radius: 12px;
        border: 2px solid var(--accent-color);
        letter-spacing: 1px;
        flex-shrink: 0;
    }

    .wallet-display {
        background: rgba(208, 228, 30, 0.2);
        padding: 15px;
        border-radius: 12px;
        margin: 15px 0;
        text-align: center;
        border: 1px solid var(--accent-color);
        flex-shrink: 0;
    }

    .wallet-number {
        font-size: 18px;
        font-weight: bold;
        color: var(--accent-color);
        word-break: break-all;
        cursor: pointer;
        padding: 12px;
        border: 1px dashed var(--accent-color);
        border-radius: 8px;
        margin: 10px 0;
        background: rgba(0, 0, 0, 0.3);
        transition: background 0.3s;
    }

    .wallet-hint {
        color: var(--secondary-text);
        font-size: 13px;
        margin-top: 8px;
    }

    .timer {
        font-size: 16px;
        color: var(--accent-color);
        text-align: center;
        margin: 15px 0;
        font-weight: bold;
        padding: 12px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 8px;
        flex-shrink: 0;
    }

    .warning-box {
        background: rgba(231, 76, 60, 0.15);
        border: 1px solid #e74c3c;
        border-radius: 10px;
        padding: 12px;
        margin: 15px 0;
        text-align: center;
        flex-shrink: 0;
    }

    .warning-title {
        color: #e74c3c;
        font-weight: bold;
        margin-bottom: 8px;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 8px;
        font-size: 14px;
    }

    .warning-text {
        color: var(--secondary-text);
        font-size: 13px;
        line-height: 1.4;
    }

    /* –ö–Ω–æ–ø–∫–∏ –≤ –ø–æ–ø–∞–ø–µ */
    .deposit-popup .btn {
        margin-top: 10px;
        padding: 14px;
        font-size: 16px;
        flex-shrink: 0;
    }

    /* –ú–æ–±–∏–ª—å–Ω–∞—è –∞–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–ø–∞–ø–∞ */
    @media (max-width: 768px) {
        .deposit-popup {
            padding: 20px;
            max-width: 95%;
            max-height: 85vh;
        }
        
        .popup-title {
            font-size: 22px;
        }
        
        .amount-display {
            font-size: 32px;
            padding: 15px;
        }
        
        .wallet-number {
            font-size: 16px;
            padding: 10px;
        }
        
        .deposit-popup .btn {
            padding: 12px;
            font-size: 15px;
        }
    }

    @media (max-width: 480px) {
        .deposit-popup {
            padding: 15px;
        }
        
        .popup-icon {
            font-size: 32px;
        }
        
        .popup-title {
            font-size: 20px;
        }
        
        .amount-display {
            font-size: 28px;
        }
        
        .wallet-number {
            font-size: 14px;
        }
        
        .timer {
            font-size: 14px;
            padding: 10px;
        }
    }

    /* –ü–û–ü–ê–ü –ü–û–î–°–ö–ê–ó–û–ö */
    .hint-popup {
        display: none;
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: var(--card-bg);
        border: 2px solid var(--accent-color);
        border-radius: 15px;
        padding: 25px;
        z-index: 1001;
        width: 90%;
        max-width: 400px;
        backdrop-filter: blur(20px);
        box-shadow: 0 20px 50px rgba(0,0,0,0.5);
    }

    .hint-popup.active {
        display: block;
    }

    .hint-content {
        margin-bottom: 20px;
    }

    .hint-title {
        color: var(--accent-color);
        font-size: 20px;
        margin-bottom: 15px;
        text-align: center;
    }

    .hint-text {
        color: var(--text-color);
        line-height: 1.5;
        font-size: 15px;
    }

    /* –£–í–ï–î–û–ú–õ–ï–ù–ò–Ø */
    .notification {
        position: fixed;
        top: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: #27ae60;
        color: white;
        padding: 15px 25px;
        border-radius: 8px;
        z-index: 998;
        display: none;
        box-shadow: 0 4px 15px rgba(0,0,0,0.3);
        text-align: center;
        min-width: 300px;
        max-width: 90%;
    }

    .notification.error {
        background: #e74c3c;
    }

    /* –°–ü–ò–ù–ù–ï–† */
    .spinner {
        border: 3px solid #f3f3f3;
        border-top: 3px solid var(--accent-color);
        border-radius: 50%;
        width: 30px;
        height: 30px;
        animation: spin 1s linear infinite;
        margin: 10px auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }

    /* –ü–†–ò–ú–ï–ß–ê–ù–ò–Ø */
    .note {
        margin-top: 25px;
        padding: 15px;
        background: rgba(255, 255, 255, 0.05);
        border-radius: 8px;
        font-size: 14px;
        color: var(--secondary-text);
        border-left: 3px solid var(--accent-color);
        text-align: center;
    }

    body[dir="rtl"] .note {
        border-left: none;
        border-right: 3px solid var(--accent-color);
    }

    /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø */
    @media (max-width: 1100px) {
        body.console-active {
            margin-right: 300px;
        }
        
        body[dir="rtl"].console-active {
            margin-left: 300px;
        }
        
        #debugConsole {
            width: 300px;
        }
    }

    @media (max-width: 900px) {
        body.console-active {
            margin-right: 250px;
        }
        
        body[dir="rtl"].console-active {
            margin-left: 250px;
        }
        
        #debugConsole {
            width: 250px;
            font-size: 11px;
        }
    }

    @media (max-width: 768px) {
        body.console-active {
            margin-right: 0 !important;
            margin-left: 0 !important;
        }
        
        #debugConsole {
            position: fixed;
            bottom: 0;
            left: 0;
            right: auto;
            width: 100%;
            height: 200px;
            top: auto;
            border-left: none;
            border-top: 2px solid var(--accent-color);
            box-shadow: 0 -5px 15px rgba(0,0,0,0.5);
        }
        
        body[dir="rtl"] #debugConsole {
            left: 0;
            right: auto;
            border-right: none;
        }
        
        .language-selector {
            position: relative;
            top: 0;
            right: 0;
            left: 0;
            justify-content: center;
            margin-bottom: 15px;
        }
        
        .deposit-popup {
            padding: 20px;
            width: 95%;
        }
        
        .amount-display {
            font-size: 36px;
            padding: 20px;
        }
        
        .wallet-number {
            font-size: 18px;
            padding: 12px;
        }
        
        .spin-letter, .better-text {
            font-size: 48px;
        }
    }

    @media (max-width: 480px) {
        .wallet-type-selector {
            grid-template-columns: 1fr;
        }
        
        .amount-display {
            font-size: 32px;
        }
        
        .spin-letter, .better-text {
            font-size: 36px;
        }
    }
</style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loadingScreen">
        <div class="loading-container">
            <div class="logo-spin">
                <span class="spin-letter">S</span>
                <span class="spin-letter">P</span>
                <span class="spin-letter">I</span>
                <span class="spin-letter">N</span>
                <span class="better-text">BETTER</span>
            </div>
            <div class="loading-subtitle">Loading payment system...</div>
        </div>
    </div>

    <!-- –ö–æ–Ω—Å–æ–ª—å –¥–µ–±–∞–≥–∞ -->
    <div id="debugConsole">
        <div class="console-header">
            <div class="console-title">Payment System Debug Console</div>
            <div class="console-close" onclick="toggleConsole()">[X]</div>
        </div>
        <div id="consoleContent"></div>
    </div>

    <!-- –Ø–∑—ã–∫–æ–≤–æ–π –ø–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å -->
    <div class="language-selector">
        <button class="lang-btn" onclick="changeLanguage('en')">EN</button>
        <button class="lang-btn" onclick="changeLanguage('ru')">RU</button>
        <button class="lang-btn" onclick="changeLanguage('fr')">FR</button>
        <button class="lang-btn" onclick="changeLanguage('ar')">AR</button>
    </div>

    <div class="container" id="mainContainer">
    <!-- –•–µ–¥–µ—Ä -->
    <div class="header">
        <div class="logo" data-i18n="title">Payment System</div>
        <div class="subtitle" data-i18n="subtitle">Secure deposits & withdrawals</div>
    </div>

        <!-- –ü–µ—Ä–µ–∫–ª—é—á–∞—Ç–µ–ª—å –≤–∫–ª–∞–¥–æ–∫ -->
        <div class="tab-container">
            <div class="tab active" onclick="switchTab('deposit')">
                <span data-i18n="deposit.tab">üí∞ Deposit</span>
            </div>
            <div class="tab" onclick="switchTab('withdrawal')">
                <span data-i18n="withdrawal.tab">üí∏ Withdrawal</span>
            </div>
        </div>

        <!-- –û–±–ª–∞—Å—Ç—å –∫–æ–Ω—Ç–µ–Ω—Ç–∞ -->
        <div class="content-area">
            <!-- –í–∫–ª–∞–¥–∫–∞ –î–µ–ø–æ–∑–∏—Ç–∞ -->
            <div id="depositTab" class="tab-content active">
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="deposit.account_label">Player Account</span>
                        <span class="info-icon" onclick="showHint('accountHint')">?</span>
                    </label>
                    <input type="text" id="account" placeholder="Enter your game account" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="deposit.amount_label">Amount</span>
                        <span class="info-icon" onclick="showHint('amountHint')">?</span>
                    </label>
                    <input type="number" id="amount" placeholder="Enter amount" min="100" required>
                    <div class="form-hint">
                        <span data-i18n="deposit.min_amount">Minimum:</span> 
                        <span id="minDeposit">100</span> 
                        <span data-i18n="currency">EGP</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="deposit.wallet_label">Your Wallet Number</span>
                        <span class="info-icon" onclick="showHint('walletHint')">?</span>
                    </label>
                    <input type="text" id="wallet" placeholder="Your personal wallet number" required>
                    <div class="form-hint">
                        <button type="button" onclick="useSavedWallet()" style="background:none;border:none;color:var(--accent-color);cursor:pointer;font-size:13px;">
                            <span data-i18n="deposit.use_saved">Use saved wallet</span>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="deposit.method_label">Payment Method</span>
                        <span class="info-icon" onclick="showHint('methodHint')">?</span>
                    </label>
                    <div class="wallet-type-selector" id="walletMethods">
                        <div class="loading">
                            <div class="spinner"></div>
                            <p style="text-align: center; color: var(--secondary-text);" data-i18n="deposit.loading_methods">
                                Loading payment methods...
                            </p>
                        </div>
                    </div>
                </div>
                
                <button class="btn" onclick="processDeposit()" id="depositBtn" data-i18n="deposit.get_wallet_button">
                    Get Deposit Wallet
                </button>
                
                <div class="note" data-i18n="deposit.note">
                    üí° Send exact amount to the provided wallet. Transaction will be processed within 5-10 minutes.
                </div>
            </div>

            <!-- –í–∫–ª–∞–¥–∫–∞ –í—ã–≤–æ–¥–∞ -->
            <div id="withdrawalTab" class="tab-content">
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="withdrawal.account_label">Player Account</span>
                        <span class="info-icon" onclick="showHint('withdrawAccountHint')">?</span>
                    </label>
                    <input type="text" id="withdrawAccount" placeholder="Enter your game account" required>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="withdrawal.amount_label">Amount</span>
                        <span class="info-icon" onclick="showHint('withdrawAmountHint')">?</span>
                    </label>
                    <input type="number" id="withdrawAmount" placeholder="Enter amount" min="300" required>
                    <div class="form-hint">
                        <span data-i18n="withdrawal.min_amount">Minimum:</span> 
                        <span id="minWithdrawal">300</span> 
                        <span data-i18n="currency">EGP</span>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="withdrawal.wallet_label">Your Wallet Number</span>
                        <span class="info-icon" onclick="showHint('withdrawWalletHint')">?</span>
                    </label>
                    <input type="text" id="withdrawWallet" placeholder="Your personal wallet number" required>
                    <div class="form-hint">
                        <button type="button" onclick="useSavedWallet()" style="background:none;border:none;color:var(--accent-color);cursor:pointer;font-size:13px;">
                            <span data-i18n="deposit.use_saved">Use saved wallet</span>
                        </button>
                    </div>
                </div>
                
                <div class="form-group">
                    <label class="form-label">
                        <span data-i18n="withdrawal.code_label">Withdrawal Code</span>
                        <span class="info-icon" onclick="showHint('codeHint')">?</span>
                    </label>
                    <input type="text" id="withdrawCode" placeholder="Enter withdrawal code" required>
                </div>
                
                <button class="btn" onclick="processWithdrawal()" id="withdrawBtn" data-i18n="withdrawal.request_button">
                    Request Withdrawal
                </button>
                
                <div class="note" data-i18n="withdrawal.note">
                    üîí Withdrawals are processed within 24 hours. Make sure the code is correct.
                </div>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ø–∞–ø —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞ –¥–µ–ø–æ–∑–∏—Ç–∞ -->
    <div class="popup-overlay" id="popupOverlay" onclick="closeDepositPopup()"></div>
    
    <div class="deposit-popup" id="depositPopup">
        <div class="popup-header">
            <div class="popup-icon">‚úÖ</div>
            <div class="popup-title" data-i18n="popup.title">Send Payment</div>
            <div class="popup-subtitle" data-i18n="popup.subtitle">Complete your deposit transaction</div>
        </div>
        
        <div class="amount-display">
            <span id="displayAmount">0</span>
        </div>
        
        <div class="wallet-display">
            <div class="wallet-hint" data-i18n="popup.wallet_hint">Send the exact amount to this wallet:</div>
            <div class="wallet-number" id="depositWallet" onclick="copyToClipboard(this.textContent)">
                Loading...
            </div>
            <div class="wallet-hint" data-i18n="popup.copy_hint">Click to copy ‚Ä¢ Valid for 15 minutes</div>
        </div>
        
        <div class="timer" id="depositTimer">
            ‚è∞ <span data-i18n="popup.time_left">Time left:</span> 15:00
        </div>
        
        <div class="warning-box">
            <div class="warning-title">‚ö†Ô∏è <span data-i18n="popup.warning_title">Important Notice</span></div>
            <div class="warning-text" data-i18n="popup.warning_text">
                If you submit requests without actually sending money, funds will NOT be credited to your account.
                Multiple fake requests may result in temporary suspension of deposit privileges.
            </div>
        </div>
        
        <button class="btn" onclick="confirmDeposit()" id="confirmBtn" data-i18n="popup.confirm_button">
            ‚úÖ I Have Sent the Payment
        </button>
        
        <button class="btn" style="background: #34495e; color: white; margin-top: 15px;" 
                onclick="closeDepositPopup()" data-i18n="popup.cancel_button">
            ‚ùå Cancel Deposit
        </button>
    </div>

    <!-- –ü–æ–ø–∞–ø –ø–æ–¥—Å–∫–∞–∑–æ–∫ -->
    <div class="popup-overlay" id="hintOverlay" onclick="closeHint()"></div>
    
    <div class="hint-popup" id="hintPopup">
        <div class="hint-content">
            <div class="hint-title" id="hintTitle">Help Information</div>
            <div class="hint-text" id="hintText">This is a help text explaining the field.</div>
        </div>
        <button class="btn" onclick="closeHint()" data-i18n="hint.understand_button">I Understand</button>
    </div>

    <!-- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ -->
    <div class="notification" id="notification"></div>

    <script>
// ========== –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø ==========
const API_URL = 'https://script.google.com/macros/s/AKfycbzsrKx2P-G6XsaqpWb6YctaOIG8WslO-a9qNSQhnOiPD8S30roYmXCJqYL3TdiSAox4/exec';
const DEBUG_MODE = false;

// ========== –ì–õ–û–ë–ê–õ–¨–ù–´–ï –ü–ï–†–ï–ú–ï–ù–ù–´–ï ==========
let state = {
    config: null,
    wallets: {},
    selectedMethod: null,
    currentDeposit: null,
    depositTimer: null,
    currentTab: 'deposit',
    currentLanguage: 'en',
    savedWallet: localStorage.getItem('userWallet') || '',
    isLoaded: false
};

// ========== –°–ò–°–¢–ï–ú–ê –õ–û–ì–ò–†–û–í–ê–ù–ò–Ø ==========
function log(type, message, data = null) {
    if (!DEBUG_MODE) return;
    
    const time = new Date().toLocaleTimeString();
    
    try {
        const entry = document.createElement('div');
        entry.className = `log-entry log-${type}`;
        
        let logMessage = `<span class="log-time">[${time}]</span> ${message}`;
        if (data) {
            logMessage += ` <span style="color:#888">${JSON.stringify(data)}</span>`;
        }
        
        entry.innerHTML = logMessage;
        const consoleContent = document.getElementById('consoleContent');
        if (consoleContent) {
            consoleContent.appendChild(entry);
            const debugConsole = document.getElementById('debugConsole');
            if (debugConsole) debugConsole.scrollTop = debugConsole.scrollHeight;
        }
    } catch (e) {}
    
    try {
        if (typeof console !== 'undefined' && console.log) {
            const logMsg = `[${time}] ${type.toUpperCase()}: ${message}`;
            if (data !== null && data !== undefined) {
                console.log(logMsg, data);
            } else {
                console.log(logMsg);
            }
        }
    } catch (e) {}
}

function toggleConsole() {
    const console = document.getElementById('debugConsole');
    console.style.display = console.style.display === 'none' ? 'block' : 'none';
}

if (DEBUG_MODE) {
    document.getElementById('debugConsole').style.display = 'block';
    log('info', 'Debug console initialized');
}

// ========== –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø ==========
function hideLoadingScreen() {
    const loadingScreen = document.getElementById('loadingScreen');
    const mainContainer = document.getElementById('mainContainer');
    
    if (!loadingScreen || !mainContainer) return;
    
    loadingScreen.style.display = 'none';
    mainContainer.style.display = 'block';
    mainContainer.style.opacity = '1';
    
    state.isLoaded = true;
    log('success', 'Page loaded');
}

window.addEventListener('load', function() {
    fetch(API_URL + '?action=get_wallets&preload=true').catch(() => {});
});

document.addEventListener('DOMContentLoaded', async function() {
    console.log('Payment System Loading...');
    
    detectLanguage();
    
    const savedAccount = localStorage.getItem('userAccount');
    if (savedAccount) {
        document.getElementById('account').value = savedAccount;
        document.getElementById('withdrawAccount').value = savedAccount;
        log('info', 'Saved account loaded from localStorage');
    }
    
    const savedWallet = localStorage.getItem('userWallet');
    if (savedWallet) {
        document.getElementById('wallet').value = savedWallet;
        document.getElementById('withdrawWallet').value = savedWallet;
        state.savedWallet = savedWallet;
        log('info', 'Saved wallet loaded from localStorage');
    }

    log('info', 'Antispam system initialized');
    
    const startTime = Date.now();
    
    try {
        const [configResult, walletsResult] = await Promise.allSettled([
            loadConfig(),
            loadWallets()
        ]);
        
        if (configResult.status === 'fulfilled') {
            log('success', 'Configuration loaded');
        } else {
            log('error', 'Config load failed', configResult.reason);
            state.config = { minDeposit: 100, minWithdrawal: 300, currency: 'EGP' };
            document.getElementById('minDeposit').textContent = '100';
            document.getElementById('minWithdrawal').textContent = '300';
            document.getElementById('amount').min = 100;
            document.getElementById('withdrawAmount').min = 300;
        }
        
        if (walletsResult.status === 'fulfilled') {
            log('success', 'Wallets loaded');
        } else {
            log('error', 'Wallets load failed', walletsResult.reason);
        }
        
        log('success', `All data loaded in ${Date.now() - startTime}ms`);
        state.isLoaded = true;
        
        const elapsedTime = Date.now() - startTime;
        const minLoadingTime = 2000;
        
        if (elapsedTime >= minLoadingTime) {
            hideLoadingScreen();
        } else {
            setTimeout(hideLoadingScreen, minLoadingTime - elapsedTime);
        }
        
    } catch (error) {
        log('error', 'Unexpected error during initialization', error);
        showNotification('network_error', true);
        setTimeout(hideLoadingScreen, 2000);
    }
});

// ========== –ú–ù–û–ì–û–Ø–ó–´–ß–ù–û–°–¢–¨ ==========
const translations = {
    en: {
        'title': 'Payment System',
        'subtitle': 'Secure deposits & withdrawals',
        'currency': 'EGP',
        'deposit.tab': 'üí∞ Deposit',
        'withdrawal.tab': 'üí∏ Withdrawal',
        'deposit.account_label': 'Player Account',
        'deposit.amount_label': 'Amount',
        'deposit.wallet_label': 'Your Wallet Number',
        'deposit.method_label': 'Payment Method',
        'deposit.min_amount': 'Minimum:',
        'deposit.use_saved': 'Use saved wallet',
        'deposit.get_wallet_button': 'Get Deposit Wallet',
        'deposit.loading_methods': 'Loading payment methods...',
        'deposit.note': 'üí° Send exact amount to the provided wallet. Transaction will be processed within 5-10 minutes.',
        'withdrawal.account_label': 'Player Account',
        'withdrawal.amount_label': 'Amount',
        'withdrawal.wallet_label': 'Your Wallet Number',
        'withdrawal.code_label': 'Withdrawal Code',
        'withdrawal.min_amount': 'Minimum:',
        'withdrawal.request_button': 'Request Withdrawal',
        'withdrawal.note': 'üîí Withdrawals are processed within 24 hours. Make sure the code is correct.',
        'popup.title': 'Send Payment',
        'popup.subtitle': 'Complete your deposit transaction',
        'popup.wallet_hint': 'Send the exact amount to this wallet:',
        'popup.copy_hint': 'Click to copy ‚Ä¢ Valid for 15 minutes',
        'popup.time_left': 'Time left:',
        'popup.warning_title': 'Important Notice',
        'popup.warning_text': 'If you submit requests without actually sending money, funds will NOT be credited to your account. Multiple fake requests may result in temporary suspension of deposit privileges.',
        'popup.confirm_button': '‚úÖ I Have Sent the Payment',
        'popup.cancel_button': '‚ùå Cancel Deposit',
        'hint.understand_button': 'I Understand',
        'notification.copied': '‚úÖ Copied to clipboard!',
        'notification.deposit_received': 'Deposit wallet received!',
        'notification.confirmed': '‚úÖ Payment confirmed! Processing...',
        'notification.cancelled': 'Deposit cancelled',
        'notification.withdrawal_submitted': '‚úÖ Withdrawal request submitted!',
        'notification.saved_wallet_used': 'Saved wallet number applied',
        'notification.fill_all_fields': 'Please fill all fields',
        'notification.select_method': 'Please select payment method',
        'notification.min_deposit': 'Minimum deposit is {amount} {currency}',
        'notification.min_withdrawal': 'Minimum withdrawal is {amount} {currency}',
        'notification.code_length': 'Withdrawal code must be at least 4 characters',
        'notification.network_error': 'Network error. Please try again.',
        'notification.time_expired': 'Deposit time expired. Please start over.',
        'notification.no_deposit': 'No deposit to confirm',
        'notification.server_error': 'Server error. Please try again.',
        'notification.confirmation_failed': 'Confirmation failed: {message}',
        'notification.antispam': 'Please wait {minutes} minutes before identical request',
        'notification.withdrawal_failed': 'Withdrawal failed: {message}'
    },
    
    ru: {
        'title': '–ü–ª–∞—Ç—ë–∂–Ω–∞—è –°–∏—Å—Ç–µ–º–∞',
        'subtitle': '–ë–µ–∑–æ–ø–∞—Å–Ω—ã–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –∏ –≤—ã–≤–æ–¥—ã',
        'currency': 'EGP',
        'deposit.tab': 'üí∞ –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ',
        'withdrawal.tab': 'üí∏ –í—ã–≤–æ–¥',
        'deposit.account_label': '–ò–≥—Ä–æ–≤–æ–π –ê–∫–∫–∞—É–Ω—Ç',
        'deposit.amount_label': '–°—É–º–º–∞',
        'deposit.wallet_label': '–í–∞—à –ù–æ–º–µ—Ä –ö–æ—à–µ–ª—å–∫–∞',
        'deposit.method_label': '–°–ø–æ—Å–æ–± –û–ø–ª–∞—Ç—ã',
        'deposit.min_amount': '–ú–∏–Ω–∏–º—É–º:',
        'deposit.use_saved': '–ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π',
        'deposit.get_wallet_button': '–ü–æ–ª—É—á–∏—Ç—å –ö–æ—à–µ–ª—ë–∫',
        'deposit.loading_methods': '–ó–∞–≥—Ä—É–∑–∫–∞ —Å–ø–æ—Å–æ–±–æ–≤ –æ–ø–ª–∞—Ç—ã...',
        'deposit.note': 'üí° –û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ —É–∫–∞–∑–∞–Ω–Ω—ã–π –∫–æ—à–µ–ª—ë–∫. –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏—è –±—É–¥–µ—Ç –æ–±—Ä–∞–±–æ—Ç–∞–Ω–∞ –≤ —Ç–µ—á–µ–Ω–∏–µ 5-10 –º–∏–Ω—É—Ç.',
        'withdrawal.account_label': '–ò–≥—Ä–æ–≤–æ–π –ê–∫–∫–∞—É–Ω—Ç',
        'withdrawal.amount_label': '–°—É–º–º–∞',
        'withdrawal.wallet_label': '–í–∞—à –ù–æ–º–µ—Ä –ö–æ—à–µ–ª—å–∫–∞',
        'withdrawal.code_label': '–ö–æ–¥ –í—ã–≤–æ–¥–∞',
        'withdrawal.min_amount': '–ú–∏–Ω–∏–º—É–º:',
        'withdrawal.request_button': '–ó–∞–ø—Ä–æ—Å–∏—Ç—å –í—ã–≤–æ–¥',
        'withdrawal.note': 'üîí –í—ã–≤–æ–¥—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è –≤ —Ç–µ—á–µ–Ω–∏–µ 24 —á–∞—Å–æ–≤. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –∫–æ–¥ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π.',
        'popup.title': '–û—Ç–ø—Ä–∞–≤–∏—Ç—å –ü–ª–∞—Ç—ë–∂',
        'popup.subtitle': '–ó–∞–≤–µ—Ä—à–∏—Ç–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏—é –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è',
        'popup.wallet_hint': '–û—Ç–ø—Ä–∞–≤—å—Ç–µ —Ç–æ—á–Ω—É—é —Å—É–º–º—É –Ω–∞ —ç—Ç–æ—Ç –∫–æ—à–µ–ª—ë–∫:',
        'popup.copy_hint': '–ù–∞–∂–º–∏—Ç–µ —á—Ç–æ–±—ã —Å–∫–æ–ø–∏—Ä–æ–≤–∞—Ç—å ‚Ä¢ –î–µ–π—Å—Ç–≤–∏—Ç–µ–ª–µ–Ω 15 –º–∏–Ω—É—Ç',
        'popup.time_left': '–û—Å—Ç–∞–ª–æ—Å—å –≤—Ä–µ–º–µ–Ω–∏:',
        'popup.warning_title': '–í–∞–∂–Ω–æ–µ –£–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ',
        'popup.warning_text': '–ï—Å–ª–∏ –≤—ã –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç–µ –∑–∞—è–≤–∫–∏ –±–µ–∑ —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–µ—Ä–µ–≤–æ–¥–∞ —Å—Ä–µ–¥—Å—Ç–≤, –¥–µ–Ω—å–≥–∏ –ù–ï –±—É–¥—É—Ç –∑–∞—á–∏—Å–ª–µ–Ω—ã –Ω–∞ –≤–∞—à –∞–∫–∫–∞—É–Ω—Ç. –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–µ–π–∫–æ–≤—ã–µ –∑–∞—è–≤–∫–∏ –º–æ–≥—É—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –≤—Ä–µ–º–µ–Ω–Ω–æ–π –±–ª–æ–∫–∏—Ä–æ–≤–∫–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è.',
        'popup.confirm_button': '‚úÖ –Ø –û—Ç–ø—Ä–∞–≤–∏–ª –ü–ª–∞—Ç—ë–∂',
        'popup.cancel_button': '‚ùå –û—Ç–º–µ–Ω–∏—Ç—å –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ',
        'hint.understand_button': '–ü–æ–Ω—è—Ç–Ω–æ',
        'notification.copied': '‚úÖ –°–∫–æ–ø–∏—Ä–æ–≤–∞–Ω–æ –≤ –±—É—Ñ–µ—Ä!',
        'notification.deposit_received': '–ö–æ—à–µ–ª—ë–∫ –¥–ª—è –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –ø–æ–ª—É—á–µ–Ω!',
        'notification.confirmed': '‚úÖ –ü–ª–∞—Ç—ë–∂ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥—ë–Ω! –û–±—Ä–∞–±–æ—Ç–∫–∞...',
        'notification.cancelled': '–ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—Ç–º–µ–Ω–µ–Ω–æ',
        'notification.withdrawal_submitted': '‚úÖ –ó–∞–ø—Ä–æ—Å –Ω–∞ –≤—ã–≤–æ–¥ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω!',
        'notification.saved_wallet_used': '–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞ –ø—Ä–∏–º–µ–Ω—ë–Ω',
        'notification.fill_all_fields': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –∑–∞–ø–æ–ª–Ω–∏—Ç–µ –≤—Å–µ –ø–æ–ª—è',
        'notification.select_method': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –≤—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã',
        'notification.min_deposit': '–ú–∏–Ω–∏–º–∞–ª—å–Ω–æ–µ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ {amount} {currency}',
        'notification.min_withdrawal': '–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –≤—ã–≤–æ–¥ {amount} {currency}',
        'notification.code_length': '–ö–æ–¥ –≤—ã–≤–æ–¥–∞ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –Ω–µ –º–µ–Ω–µ–µ 4 —Å–∏–º–≤–æ–ª–æ–≤',
        'notification.network_error': '–û—à–∏–±–∫–∞ —Å–µ—Ç–∏. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.',
        'notification.time_expired': '–í—Ä–µ–º—è –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –∏—Å—Ç–µ–∫–ª–æ. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –Ω–∞—á–Ω–∏—Ç–µ –∑–∞–Ω–æ–≤–æ.',
        'notification.no_deposit': '–ù–µ—Ç –ø–æ–ø–æ–ª–Ω–µ–Ω–∏—è –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è',
        'notification.server_error': '–û—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞.',
        'notification.confirmation_failed': '–ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –Ω–µ —É–¥–∞–ª–æ—Å—å: {message}',
        'notification.antispam': '–ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ {minutes} –º–∏–Ω—É—Ç –ø–µ—Ä–µ–¥ –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º',
        'notification.withdrawal_failed': '–í—ã–≤–æ–¥ –Ω–µ —É–¥–∞–ª—Å—è: {message}'
    },
    
    fr: {
        'title': 'Syst√®me de Paiement',
        'subtitle': 'D√©p√¥ts et retraits s√©curis√©s',
        'currency': 'EGP',
        'deposit.tab': 'üí∞ D√©p√¥t',
        'withdrawal.tab': 'üí∏ Retrait',
        'deposit.account_label': 'Compte Joueur',
        'deposit.amount_label': 'Montant',
        'deposit.wallet_label': 'Votre Num√©ro de Portefeuille',
        'deposit.method_label': 'M√©thode de Paiement',
        'deposit.min_amount': 'Minimum:',
        'deposit.use_saved': 'Utiliser le portefeuille sauvegard√©',
        'deposit.get_wallet_button': 'Obtenir le Portefeuille',
        'deposit.loading_methods': 'Chargement des m√©thodes de paiement...',
        'deposit.note': 'üí° Envoyez le montant exact au portefeuille fourni. La transaction sera trait√©e dans les 5-10 minutes.',
        'withdrawal.account_label': 'Compte Joueur',
        'withdrawal.amount_label': 'Montant',
        'withdrawal.wallet_label': 'Votre Num√©ro de Portefeuille',
        'withdrawal.code_label': 'Code de Retrait',
        'withdrawal.min_amount': 'Minimum:',
        'withdrawal.request_button': 'Demander un Retrait',
        'withdrawal.note': 'üîí Les retraits sont trait√©s dans les 24 heures. Assurez-vous que le code est correct.',
        'popup.title': 'Envoyer le Paiement',
        'popup.subtitle': 'Compl√©tez votre transaction de d√©p√¥t',
        'popup.wallet_hint': 'Envoyez le montant exact √† ce portefeuille:',
        'popup.copy_hint': 'Cliquez pour copier ‚Ä¢ Valide 15 minutes',
        'popup.time_left': 'Temps restant:',
        'popup.warning_title': 'Avis Important',
        'popup.warning_text': 'Si vous soumettez des demandes sans envoyer d\'argent, les fonds NE seront PAS cr√©dit√©s sur votre compte. De multiples fausses demandes peuvent entra√Æner une suspension temporaire des privil√®ges de d√©p√¥t.',
        'popup.confirm_button': '‚úÖ J\'ai Envoy√© le Paiement',
        'popup.cancel_button': '‚ùå Annuler le D√©p√¥t',
        'hint.understand_button': 'Je Comprends',
        'notification.copied': '‚úÖ Copi√© dans le presse-papiers!',
        'notification.deposit_received': 'Portefeuille de d√©p√¥t re√ßu!',
        'notification.confirmed': '‚úÖ Paiement confirm√©! Traitement...',
        'notification.cancelled': 'D√©p√¥t annul√©',
        'notification.withdrawal_submitted': '‚úÖ Demande de retrait soumise!',
        'notification.saved_wallet_used': 'Num√©ro de portefeuille sauvegard√© appliqu√©',
        'notification.fill_all_fields': 'Veuillez remplir tous les champs',
        'notification.select_method': 'Veuillez s√©lectionner une m√©thode de paiement',
        'notification.min_deposit': 'D√©p√¥t minimum {amount} {currency}',
        'notification.min_withdrawal': 'Retrait minimum {amount} {currency}',
        'notification.code_length': 'Le code de retrait doit comporter au moins 4 caract√®res',
        'notification.network_error': 'Erreur r√©seau. Veuillez r√©essayer.',
        'notification.time_expired': 'Le temps de d√©p√¥t a expir√©. Veuillez recommencer.',
        'notification.no_deposit': 'Aucun d√©p√¥t √† confirmer',
        'notification.server_error': 'Erreur serveur. Veuillez r√©essayer.',
        'notification.confirmation_failed': '√âchec de la confirmation: {message}',
        'notification.antispam': 'Veuillez attendre {minutes} minutes avant une demande identique',
        'notification.withdrawal_failed': '√âchec du retrait: {message}'
    },
    
    ar: {
        'title': 'ŸÜÿ∏ÿßŸÖ ÿßŸÑÿØŸÅÿπ',
        'subtitle': 'ÿ•ŸäÿØÿßÿπÿßÿ™ Ÿàÿ≥ÿ≠Ÿàÿ®ÿßÿ™ ÿ¢ŸÖŸÜÿ©',
        'currency': 'ÿ¨ŸÜŸäŸá ŸÖÿµÿ±Ÿä',
        'deposit.tab': 'üí∞ ÿ•ŸäÿØÿßÿπ',
        'withdrawal.tab': 'üí∏ ÿ≥ÿ≠ÿ®',
        'deposit.account_label': 'ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÑÿßÿπÿ®',
        'deposit.amount_label': 'ÿßŸÑŸÖÿ®ŸÑÿ∫',
        'deposit.wallet_label': 'ÿ±ŸÇŸÖ ŸÖÿ≠ŸÅÿ∏ÿ™ŸÉ',
        'deposit.method_label': 'ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ',
        'deposit.min_amount': 'ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ:',
        'deposit.use_saved': 'ÿßÿ≥ÿ™ÿÆÿØŸÖ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏ÿ©',
        'deposit.get_wallet_button': 'ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸâ ŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑÿ•ŸäÿØÿßÿπ',
        'deposit.loading_methods': 'ÿ¨ÿßÿ±Ÿä ÿ™ÿ≠ŸÖŸäŸÑ ÿ∑ÿ±ŸÇ ÿßŸÑÿØŸÅÿπ...',
        'deposit.note': 'üí° ÿ£ÿ±ÿ≥ŸÑ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ≠ÿØÿØ ÿ•ŸÑŸâ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑŸÖŸÇÿØŸÖÿ©. ÿ≥ÿ™ÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑŸÖÿπÿßŸÖŸÑÿ© ÿÆŸÑÿßŸÑ 5-10 ÿØŸÇÿßÿ¶ŸÇ.',
        'withdrawal.account_label': 'ÿ≠ÿ≥ÿßÿ® ÿßŸÑŸÑÿßÿπÿ®',
        'withdrawal.amount_label': 'ÿßŸÑŸÖÿ®ŸÑÿ∫',
        'withdrawal.wallet_label': 'ÿ±ŸÇŸÖ ŸÖÿ≠ŸÅÿ∏ÿ™ŸÉ',
        'withdrawal.code_label': 'ŸÉŸàÿØ ÿßŸÑÿ≥ÿ≠ÿ®',
        'withdrawal.min_amount': 'ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ:',
        'withdrawal.request_button': 'ÿ∑ŸÑÿ® ÿßŸÑÿ≥ÿ≠ÿ®',
        'withdrawal.note': 'üîí ÿ™ÿ™ŸÖ ŸÖÿπÿßŸÑÿ¨ÿ© ÿßŸÑÿ≥ÿ≠Ÿàÿ®ÿßÿ™ ÿÆŸÑÿßŸÑ 24 ÿ≥ÿßÿπÿ©. ÿ™ÿ£ŸÉÿØ ŸÖŸÜ ÿµÿ≠ÿ© ÿßŸÑŸÉŸàÿØ.',
        'popup.title': 'ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿØŸÅÿπ',
        'popup.subtitle': 'ÿ£ŸÉŸÖŸÑ ŸÖÿπÿßŸÖŸÑÿ© ÿßŸÑÿ•ŸäÿØÿßÿπ',
        'popup.wallet_hint': 'ÿ£ÿ±ÿ≥ŸÑ ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑŸÖÿ≠ÿØÿØ ÿ•ŸÑŸâ Ÿáÿ∞Ÿá ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ©:',
        'popup.copy_hint': 'ÿßŸÜŸÇÿ± ŸÑŸÑŸÜÿ≥ÿÆ ‚Ä¢ ÿµÿßŸÑÿ≠ ŸÑŸÖÿØÿ© 15 ÿØŸÇŸäŸÇÿ©',
        'popup.time_left': 'ÿßŸÑŸàŸÇÿ™ ÿßŸÑŸÖÿ™ÿ®ŸÇŸä:',
        'popup.warning_title': 'ÿ•ÿ¥ÿπÿßÿ± ŸÖŸáŸÖ',
        'popup.warning_text': 'ÿ•ÿ∞ÿß ŸÇŸÖÿ™ ÿ®ÿ™ŸÇÿØŸäŸÖ ÿ∑ŸÑÿ®ÿßÿ™ ÿØŸàŸÜ ÿ•ÿ±ÿ≥ÿßŸÑ ÿßŸÑÿ£ŸÖŸàÿßŸÑ ŸÅÿπŸÑŸäŸãÿßÿå ŸÅŸÑŸÜ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ£ŸÖŸàÿßŸÑ ÿ•ŸÑŸâ ÿ≠ÿ≥ÿßÿ®ŸÉ. ŸÇÿØ ÿ™ÿ§ÿØŸä ÿßŸÑÿ∑ŸÑÿ®ÿßÿ™ ÿßŸÑŸÖÿ≤ŸäŸÅÿ© ÿßŸÑŸÖÿ™ÿπÿØÿØÿ© ÿ•ŸÑŸâ ÿ™ÿπŸÑŸäŸÇ ŸÖÿ§ŸÇÿ™ ŸÑÿßŸÖÿ™Ÿäÿßÿ≤ÿßÿ™ ÿßŸÑÿ•ŸäÿØÿßÿπ.',
        'popup.confirm_button': '‚úÖ ŸÑŸÇÿØ ÿ£ÿ±ÿ≥ŸÑÿ™ ÿßŸÑÿØŸÅÿπ',
        'popup.cancel_button': '‚ùå ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ•ŸäÿØÿßÿπ',
        'hint.understand_button': 'ŸÅŸáŸÖÿ™',
        'notification.copied': '‚úÖ ÿ™ŸÖ ÿßŸÑŸÜÿ≥ÿÆ ÿ•ŸÑŸâ ÿßŸÑÿ≠ÿßŸÅÿ∏ÿ©!',
        'notification.deposit_received': 'ÿ™ŸÖ ÿßÿ≥ÿ™ŸÑÿßŸÖ ŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑÿ•ŸäÿØÿßÿπ!',
        'notification.confirmed': '‚úÖ ÿ™ŸÖ ÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿØŸÅÿπ! ÿ¨ÿßÿ±Ÿä ÿßŸÑŸÖÿπÿßŸÑÿ¨ÿ©...',
        'notification.cancelled': 'ÿ™ŸÖ ÿ•ŸÑÿ∫ÿßÿ° ÿßŸÑÿ•ŸäÿØÿßÿπ',
        'notification.withdrawal_submitted': '‚úÖ ÿ™ŸÖ ÿ™ŸÇÿØŸäŸÖ ÿ∑ŸÑÿ® ÿßŸÑÿ≥ÿ≠ÿ®!',
        'notification.saved_wallet_used': 'ÿ™ŸÖ ÿ™ÿ∑ÿ®ŸäŸÇ ÿ±ŸÇŸÖ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑŸÖÿ≠ŸÅŸàÿ∏',
        'notification.fill_all_fields': 'Ÿäÿ±ÿ¨Ÿâ ŸÖŸÑÿ° ÿ¨ŸÖŸäÿπ ÿßŸÑÿ≠ŸÇŸàŸÑ',
        'notification.select_method': 'Ÿäÿ±ÿ¨Ÿâ ÿßÿÆÿ™Ÿäÿßÿ± ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ',
        'notification.min_deposit': 'ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑÿ•ŸäÿØÿßÿπ {amount} {currency}',
        'notification.min_withdrawal': 'ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ ŸÑŸÑÿ≥ÿ≠ÿ® {amount} {currency}',
        'notification.code_length': 'Ÿäÿ¨ÿ® ÿ£ŸÜ ŸäŸÉŸàŸÜ ŸÉŸàÿØ ÿßŸÑÿ≥ÿ≠ÿ® 4 ÿ£ÿ≠ÿ±ŸÅ ÿπŸÑŸâ ÿßŸÑÿ£ŸÇŸÑ',
        'notification.network_error': 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿ¥ÿ®ŸÉÿ©. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',
        'notification.time_expired': 'ÿßŸÜÿ™ŸáŸâ ŸàŸÇÿ™ ÿßŸÑÿ•ŸäÿØÿßÿπ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿ®ÿØÿ° ŸÖŸÜ ÿ¨ÿØŸäÿØ.',
        'notification.no_deposit': 'ŸÑÿß ŸäŸàÿ¨ÿØ ÿ•ŸäÿØÿßÿπ ŸÑÿ™ÿ£ŸÉŸäÿØ',
        'notification.server_error': 'ÿÆÿ∑ÿ£ ŸÅŸä ÿßŸÑÿÆÿßÿØŸÖ. Ÿäÿ±ÿ¨Ÿâ ÿßŸÑŸÖÿ≠ÿßŸàŸÑÿ© ŸÖÿ±ÿ© ÿ£ÿÆÿ±Ÿâ.',
        'notification.confirmation_failed': 'ŸÅÿ¥ŸÑ ÿßŸÑÿ™ÿ£ŸÉŸäÿØ: {message}',
        'notification.antispam': 'Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ± {minutes} ÿØŸÇÿßÿ¶ŸÇ ŸÇÿ®ŸÑ ÿßŸÑÿ∑ŸÑÿ® ÿßŸÑŸÖŸÖÿßÿ´ŸÑ',
        'notification.withdrawal_failed': 'ŸÅÿ¥ŸÑ ÿßŸÑÿ≥ÿ≠ÿ®: {message}'
    }
};

function detectLanguage() {
    const browserLang = navigator.language || navigator.userLanguage;
    let lang = 'en';
    
    if (browserLang.startsWith('ru')) lang = 'ru';
    else if (browserLang.startsWith('fr')) lang = 'fr';
    else if (browserLang.startsWith('ar')) lang = 'ar';
    
    changeLanguage(lang);
    log('info', `Browser language detected: ${browserLang}, using: ${lang}`);
}

function changeLanguage(lang) {
    if (!translations[lang]) {
        lang = 'en';
        log('warning', `Language ${lang} not found, defaulting to English`);
    }
    
    state.currentLanguage = lang;
    document.documentElement.lang = lang;
    
    if (lang === 'ar') {
        document.body.setAttribute('dir', 'rtl');
        log('info', 'RTL direction applied for Arabic');
    } else {
        document.body.removeAttribute('dir');
    }
    
    document.querySelectorAll('.lang-btn').forEach(btn => {
        btn.classList.remove('active');
        if (btn.textContent === lang.toUpperCase()) {
            btn.classList.add('active');
        }
    });
    
    applyTranslations(lang);
    log('info', `Language changed to: ${lang}`);
}

function applyTranslations(lang) {
    const trans = translations[lang];
    
    document.querySelectorAll('[data-i18n]').forEach(element => {
        const key = element.getAttribute('data-i18n');
        if (trans[key]) {
            element.textContent = trans[key];
        }
    });
}

function translate(key, params = {}) {
    let text = translations[state.currentLanguage][key] || translations['en'][key] || key;
    
    for (const [param, value] of Object.entries(params)) {
        text = text.replace(`{${param}}`, value);
    }
    
    return text;
}

/*// ========== –ü–û–î–°–ö–ê–ó–ö–ò ==========
const hints = {
    'accountHint': {
        title: 'Player Account',
        text: 'Enter your game account username or ID. This is required to credit funds to your account.'
    },
    'amountHint': {
        title: 'Amount',
        text: 'Enter the amount you want to deposit. Minimum deposit is 100 EGP.'
    },
    'walletHint': {
        title: 'Your Wallet Number',
        text: 'Enter your personal wallet number (Vodafone Cash, InstaPay, etc.). This wallet will be used for withdrawals.'
    },
    'methodHint': {
        title: 'Payment Method',
        text: 'Select the payment method you want to use for this deposit.'
    },
    'withdrawAccountHint': {
        title: 'Player Account',
        text: 'Enter your game account username or ID. This is required to process your withdrawal.'
    },
    'withdrawAmountHint': {
        title: 'Amount',
        text: 'Enter the amount you want to withdraw. Minimum withdrawal is 300 EGP.'
    },
    'withdrawWalletHint': {
        title: 'Your Wallet Number',
        text: 'Enter your personal wallet number where you want to receive the withdrawal.'
    },
    'codeHint': {
        title: 'Withdrawal Code',
        text: 'Enter the withdrawal code provided by the game or system. This code is required for security.'
    }
};*/

/*function showHint(hintId) {
    const hint = hints[hintId];
    if (!hint) return;
    
    document.getElementById('hintTitle').textContent = translateHint(hint.title);
    document.getElementById('hintText').textContent = translateHint(hint.text);
    
    document.getElementById('hintOverlay').classList.add('active');
    document.getElementById('hintPopup').classList.add('active');
    
    log('info', `Hint shown: ${hintId}`);
}*/

        // ========== –ü–û–î–°–ö–ê–ó–ö–ò ==========
        const hints = {
            'accountHint': {
                en: 'Enter your game account username or ID. This is required to credit funds to your account.',
                ru: '–í–∞—à –Ω–æ–º–µ—Ä –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –µ–≥–æ –Ω–∞ —Å–∞–π—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.',
                fr: 'Votre num√©ro de profil de jeu. Vous pouvez le trouver sur le site dans les param√®tres de votre profil.',
                ar: 'ÿ±ŸÇŸÖ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä ŸÑŸÑÿπÿ®ÿ©. ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸäŸá ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿ•ÿπÿØÿßÿØÿßÿ™ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä.'
            },
            'amountHint': {
                en: 'The amount you plan to deposit. Minimum {minDeposit} {currency}.',
                ru: '–°—É–º–º–∞ –∫–æ—Ç–æ—Ä—É—é –≤—ã –ø–ª–∞–Ω–∏—Ä—É–µ—Ç–µ –≤–Ω–µ—Å—Ç–∏. –ú–∏–Ω–∏–º—É–º {minDeposit} {currency}.',
                fr: 'Le montant que vous pr√©voyez de d√©poser. Minimum {minDeposit} {currency}.',
                ar: 'ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿßŸÑÿ∞Ÿä ÿ™ÿÆÿ∑ÿ∑ ŸÑŸÑÿ•ŸäÿØÿßÿπ. ÿßŸÑÿ≠ÿØ ÿßŸÑÿ£ÿØŸÜŸâ {minDeposit} {currency}.'
            },
            'walletHint': {
                en: 'Here you need to enter your wallet number from which you will transfer money. Be careful, if the number is entered incorrectly, the amount may not be credited to your profile, or may be credited with a delay.',
                ru: '–¢—É—Ç –≤–∞–º –Ω—É–∂–Ω–æ —É–∫–∞–∑–∞—Ç—å –Ω–æ–º–µ—Ä –≤–∞—à–µ–≥–æ –∫–æ—à–µ–ª—å–∫–∞, —Å –∫–æ—Ç–æ—Ä–æ–≥–æ –≤—ã –±—É–¥–µ—Ç–µ –ø–µ—Ä–µ–≤–æ–¥–∏—Ç—å –¥–µ–Ω—å–≥–∏. –ë—É–¥—å—Ç–µ –≤–Ω–∏–º–∞—Ç–µ–ª—å–Ω—ã, –µ—Å–ª–∏ –Ω–æ–º–µ—Ä –±—É–¥–µ—Ç —É–∫–∞–∑–∞–Ω –Ω–µ –≤–µ—Ä–Ω–æ, —Å—É–º–º–∞ –º–æ–∂–µ—Ç –Ω–µ –ø–æ—Å—Ç—É–ø–∏—Ç—å –Ω–∞ –≤–∞—à –ø—Ä–æ—Ñ–∏–ª—å, –∏–ª–∏ –ø–æ—Å—Ç—É–ø–∏—Ç—å —Å –∑–∞–¥–µ—Ä–∂–∫–æ–π.',
                fr: 'Ici, vous devez indiquer le num√©ro de votre portefeuille depuis lequel vous effectuerez le transfert. Soyez prudent, si le num√©ro est incorrect, le montant peut ne pas √™tre cr√©dit√© sur votre profil, ou peut √™tre cr√©dit√© avec un retard.',
                ar: 'ŸáŸÜÿß ÿ™ÿ≠ÿ™ÿßÿ¨ ÿ•ŸÑŸâ ÿ•ÿØÿÆÿßŸÑ ÿ±ŸÇŸÖ ŸÖÿ≠ŸÅÿ∏ÿ™ŸÉ ÿßŸÑÿ™Ÿä ÿ≥ÿ™ŸÇŸàŸÖ ÿ®ÿßŸÑÿ™ÿ≠ŸàŸäŸÑ ŸÖŸÜŸáÿß. ŸÉŸÜ ÿ≠ÿ∞ÿ±Ÿãÿßÿå ÿ•ÿ∞ÿß ÿ™ŸÖ ÿ•ÿØÿÆÿßŸÑ ÿßŸÑÿ±ŸÇŸÖ ÿ®ÿ¥ŸÉŸÑ ÿ∫Ÿäÿ± ÿµÿ≠Ÿäÿ≠ÿå ŸÅŸÇÿØ ŸÑÿß Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑŸÖÿ®ŸÑÿ∫ ÿ•ŸÑŸâ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸäÿå ÿ£Ÿà ŸÇÿØ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ™Ÿá ÿ®ÿ™ÿ£ÿÆŸäÿ±.'
            },
            'methodHint': {
                en: 'Select the payment method you want to use for this deposit.',
                ru: '–í—ã–±–µ—Ä–∏—Ç–µ —Å–ø–æ—Å–æ–± –æ–ø–ª–∞—Ç—ã, –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è —ç—Ç–æ–≥–æ –¥–µ–ø–æ–∑–∏—Ç–∞.',
                fr: 'S√©lectionnez la m√©thode de paiement que vous souhaitez utiliser pour ce d√©p√¥t.',
                ar: 'ÿ≠ÿØÿØ ÿ∑ÿ±ŸäŸÇÿ© ÿßŸÑÿØŸÅÿπ ÿßŸÑÿ™Ÿä ÿ™ÿ±ŸäÿØ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖŸáÿß ŸÑŸáÿ∞ÿß ÿßŸÑÿ•ŸäÿØÿßÿπ.'
            },
            'withdrawAccountHint': {
                en: 'Enter your game account username or ID. This is required to process your withdrawal.',
                ru: '–í–∞—à –Ω–æ–º–µ—Ä –∏–≥—Ä–æ–≤–æ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è. –í—ã –º–æ–∂–µ—Ç–µ –Ω–∞–π—Ç–∏ –µ–≥–æ –Ω–∞ —Å–∞–π—Ç–µ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö –≤–∞—à–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è.',
                fr: 'Votre num√©ro de profil de jeu. Vous pouvez le trouver sur le site dans les param√®tres de votre profil.',
                ar: 'ÿ±ŸÇŸÖ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä ŸÑŸÑÿπÿ®ÿ©. ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿπÿ´Ÿàÿ± ÿπŸÑŸäŸá ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿ•ÿπÿØÿßÿØÿßÿ™ ŸÖŸÑŸÅŸÉ ÿßŸÑÿ¥ÿÆÿµŸä.'
            },
            'withdrawAmountHint': {
                en: 'The amount of the withdrawal request you previously made on the website.',
                ru: '–°—É–º–º–∞ –∑–∞—è–≤–∫–∏ –Ω–∞ –≤—ã–≤–æ–¥ –∫–æ—Ç–æ—Ä—É—é –≤—ã —Ä–∞–Ω–µ–µ –æ—Ñ–æ—Ä–º–∏–ª–∏ –Ω–∞ —Å–∞–π—Ç–µ.',
                fr: 'Le montant de la demande de retrait que vous avez faite pr√©c√©demment sur le site.',
                ar: 'ŸÖÿ®ŸÑÿ∫ ÿ∑ŸÑÿ® ÿßŸÑÿ≥ÿ≠ÿ® ÿßŸÑÿ∞Ÿä ŸÇŸÖÿ™ ÿ®Ÿá ŸÖÿ≥ÿ®ŸÇŸãÿß ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ.'
            },
            'withdrawWalletHint': {
                en: 'Your wallet number where you want to receive the withdrawal. By default, the wallet number used for the last deposit is used.',
                ru: '–í–∞—à –Ω–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞ –Ω–∞ –∫–æ—Ç–æ—Ä—ã–π –≤—ã —Ö–æ—Ç–∏—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –≤—ã–≤–æ–¥. –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–æ–º–µ—Ä –∫–æ—à–µ–ª—å–∫–∞ –∫–æ—Ç–æ—Ä—ã–π –±—ã–ª –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω –¥–ª—è –¥–µ–ø–æ–∏—Ç–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–º.',
                fr: 'Votre num√©ro de portefeuille o√π vous souhaitez recevoir le retrait. Par d√©faut, le num√©ro de portefeuille utilis√© pour le dernier d√©p√¥t est utilis√©.',
                ar: 'ÿ±ŸÇŸÖ ŸÖÿ≠ŸÅÿ∏ÿ™ŸÉ ÿ≠Ÿäÿ´ ÿ™ÿ±ŸäÿØ ÿßÿ≥ÿ™ŸÑÿßŸÖ ÿßŸÑÿ≥ÿ≠ÿ®. ÿßŸÅÿ™ÿ±ÿßÿ∂ŸäŸãÿßÿå Ÿäÿ™ŸÖ ÿßÿ≥ÿ™ÿÆÿØÿßŸÖ ÿ±ŸÇŸÖ ÿßŸÑŸÖÿ≠ŸÅÿ∏ÿ© ÿßŸÑŸÖÿ≥ÿ™ÿÆÿØŸÖ ŸÑŸÑÿ•ŸäÿØÿßÿπ ÿßŸÑÿ£ÿÆŸäÿ±.'
            },
            'codeHint': {
                en: 'Special code to confirm the withdrawal. You can get it on the website in the section (Withdrawal History -> Withdrawal Code).',
                ru: '–°–ø–µ—Ü–∏–∞–ª—å–Ω—ã–π –∫–æ–¥ –¥–ª—è –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è –≤—ã–≤–æ–¥–∞. –í—ã –º–æ–∂–µ—Ç–µ –ø–æ–ª—É—á–∏—Ç—å –µ–≥–æ –Ω–∞ —Å–∞–π—Ç–µ –≤ —Ä–∞–∑–¥–µ–ª–µ (–ò—Å—Ç–æ—Ä–∏—è –≤—ã–≤–æ–¥–æ–≤->–ö–æ–¥ –¥–ª—è –≤—ã–≤–æ–¥–∞).',
                fr: 'Code sp√©cial pour confirmer le retrait. Vous pouvez l\'obtenir sur le site dans la section (Historique des retraits -> Code de retrait).',
                ar: 'ŸÉŸàÿØ ÿÆÿßÿµ ŸÑÿ™ÿ£ŸÉŸäÿØ ÿßŸÑÿ≥ÿ≠ÿ®. ŸäŸÖŸÉŸÜŸÉ ÿßŸÑÿ≠ÿµŸàŸÑ ÿπŸÑŸäŸá ÿπŸÑŸâ ÿßŸÑŸÖŸàŸÇÿπ ŸÅŸä ÿßŸÑŸÇÿ≥ŸÖ (ÿ≥ÿ¨ŸÑ ÿßŸÑÿ≥ÿ≠Ÿàÿ®ÿßÿ™ -> ŸÉŸàÿØ ÿßŸÑÿ≥ÿ≠ÿ®).'
            }
        };
        
        function showHint(hintId) {
            const hint = hints[hintId];
            if (!hint) return;
            
            // Get title translation based on field name
            const titleKeys = {
                'accountHint': 'Player Account',
                'amountHint': 'Amount',
                'walletHint': 'Your Wallet Number',
                'methodHint': 'Payment Method',
                'withdrawAccountHint': 'Player Account',
                'withdrawAmountHint': 'Amount',
                'withdrawWalletHint': 'Your Wallet Number',
                'codeHint': 'Withdrawal Code'
            };
            
            const title = translate(titleKeys[hintId] || 'Help Information');
            const text = hint[state.currentLanguage] || hint.en;
            
            // Replace variables in hint text
            let formattedText = text;
            if (hintId === 'amountHint') {
                formattedText = text
                    .replace('{minDeposit}', state.config?.minDeposit || 100)
                    .replace('{currency}', state.config?.currency || 'EGP');
            }
            
            document.getElementById('hintTitle').textContent = title;
            document.getElementById('hintText').textContent = formattedText;
            
            document.getElementById('hintOverlay').classList.add('active');
            document.getElementById('hintPopup').classList.add('active');
            
            log('info', `Hint shown: ${hintId}`);
        }

function closeHint() {
    document.getElementById('hintOverlay').classList.remove('active');
    document.getElementById('hintPopup').classList.remove('active');
}

/*function translateHint(text) {
    if (state.currentLanguage === 'ru') {
        const ruHints = {
            'Player Account': '–ò–≥—Ä–æ–≤–æ–π –ê–∫–∫–∞—É–Ω—Ç',
            'Amount': '–°—É–º–º–∞',
            'Your Wallet Number': '–í–∞—à –ù–æ–º–µ—Ä –ö–æ—à–µ–ª—å–∫–∞',
            'Payment Method': '–°–ø–æ—Å–æ–± –û–ø–ª–∞—Ç—ã',
            'Withdrawal Code': '–ö–æ–¥ –í—ã–≤–æ–¥–∞'
        };
        return ruHints[text] || text;
    }
    return text;
}*/

// ========== –£–¢–ò–õ–ò–¢–´ ==========
function showNotification(messageKey, isError = false, params = {}) {
    const message = translate(messageKey, params);
    const notification = document.getElementById('notification');
    notification.textContent = message;
    notification.className = `notification ${isError ? 'error' : 'success'}`;
    notification.style.display = 'block';
    setTimeout(() => notification.style.display = 'none', 3000);
    
    log(isError ? 'error' : 'success', `Notification: ${message}`);
}

// ========== –ü–ï–†–ï–ö–õ–Æ–ß–ï–ù–ò–ï –í–ö–õ–ê–î–û–ö ==========
function switchTab(tabName) {
    if (!state.isLoaded) return;
    
    state.currentTab = tabName;
    
    document.querySelectorAll('.tab').forEach(tab => tab.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(content => content.classList.remove('active'));
    
    document.querySelector(`.tab[onclick*="${tabName}"]`).classList.add('active');
    document.getElementById(tabName + 'Tab').classList.add('active');
    
    log('info', `Tab switched to: ${tabName}`);
}

// ========== –°–û–•–†–ê–ù–ï–ù–ò–ï –ö–û–®–ï–õ–¨–ö–ê ==========
function useSavedWallet() {
    if (state.savedWallet) {
        if (state.currentTab === 'deposit') {
            document.getElementById('wallet').value = state.savedWallet;
        } else {
            document.getElementById('withdrawWallet').value = state.savedWallet;
        }
        showNotification('saved_wallet_used');
        log('info', 'Saved wallet applied to form');
    }
}

// ========== –ó–ê–ì–†–£–ó–ö–ê –ö–û–ù–§–ò–ì–£–†–ê–¶–ò–ò ==========
async function loadConfig() {
    try {
        const url = API_URL + '?action=get_config&t=' + Date.now();
        log('info', `Fetching config from: ${url}`);
        
        const response = await fetch(url);
        const result = await response.json();
        
        log('info', 'Config response received', result);
        
        if (result.status === 'success') {
            state.config = result.config;
            document.getElementById('minDeposit').textContent = state.config.minDeposit;
            document.getElementById('minWithdrawal').textContent = state.config.minWithdrawal;
            document.getElementById('amount').min = state.config.minDeposit;
            document.getElementById('withdrawAmount').min = state.config.minWithdrawal;
            
            log('success', 'Configuration loaded successfully', state.config);
        } else {
            log('error', 'Failed to load config', result);
            throw new Error(result.message || 'Config load failed');
        }
    } catch (error) {
        state.config = { minDeposit: 100, minWithdrawal: 300, currency: 'EGP' };
        log('warning', 'Using default config due to error', error);
    }
}

// ========== –ó–ê–ì–†–£–ó–ö–ê –ö–û–®–ï–õ–¨–ö–û–í ==========
async function loadWallets() {
  try {
    const url = API_URL + '?action=get_wallets&t=' + Date.now();
    log('info', `Fetching wallets from: ${url}`);
    
    const response = await fetch(url);
    const result = await response.json();
    
    log('info', 'Wallets response received', { 
      status: result.status,
      source: result.source,
      count: result.wallets ? Object.keys(result.wallets).length : 0
    });
    
    if (result.status === 'success') {
      // –°–ò–ù–•–†–û–ù–ò–ó–ò–†–û–í–ê–ù–ù–ê–Ø –°–¢–†–£–ö–¢–£–†–ê: –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–º–µ—Ä–∞ –≤ –º–∞—Å—Å–∏–≤–µ availableNumbers
      state.wallets = result.wallets;
      renderWalletMethods();
      
      log('success', 'Wallets loaded successfully', {
        count: Object.keys(state.wallets).length,
        types: Object.keys(state.wallets).map(type => ({
          type: type,
          name: state.wallets[type].name,
          available: state.wallets[type].availableNumbers?.length || 0
        }))
      });
    } else {
      log('error', 'Failed to load wallets', result);
      throw new Error(result.message || 'Wallets load failed');
    }
  } catch (error) {
    // –ù–ò–ö–ê–ö–ò–• –¢–ï–°–¢–û–í–´–• –ö–û–®–ï–õ–¨–ö–û–í - —Ç–æ–ª—å–∫–æ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ–± –æ—à–∏–±–∫–µ
    log('error', 'Wallets load failed completely', error);
    state.wallets = {};
    
    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
    document.getElementById('walletMethods').innerHTML = `
      <div style="text-align: center; padding: 20px; color: #e74c3c;">
        <div style="font-size: 24px;">‚ö†Ô∏è</div>
        <div style="font-weight: bold; margin: 10px 0;">Payment methods not available</div>
        <div style="color: var(--secondary-text); font-size: 14px;">
          Please try again later or contact support
        </div>
      </div>
    `;
    
    // –ë–ª–æ–∫–∏—Ä—É–µ–º –∫–Ω–æ–ø–∫—É –¥–µ–ø–æ–∑–∏—Ç–∞
    document.getElementById('depositBtn').disabled = true;
    document.getElementById('depositBtn').innerHTML = 
      '<span style="color: #e74c3c;">‚ö†Ô∏è Payment methods unavailable</span>';
  }
}

function renderWalletMethods() {
  const container = document.getElementById('walletMethods');
  if (!state.wallets || Object.keys(state.wallets).length === 0) {
    container.innerHTML = `
      <div style="text-align: center; padding: 20px; color: var(--secondary-text);">
        <div class="spinner"></div>
        <p style="margin-top: 10px;">Loading payment methods...</p>
      </div>
    `;
    log('warning', 'No payment methods available to render');
    return;
  }
  
  let html = '';
  let enabledCount = 0;
  
  Object.entries(state.wallets).forEach(([type, wallet]) => {
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º, –µ—Å—Ç—å –ª–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–æ–º–µ—Ä–∞
    const hasAvailableNumbers = wallet.availableNumbers && wallet.availableNumbers.length > 0;
    
    if (wallet.enabled && hasAvailableNumbers) {
      enabledCount++;
      const isActive = state.selectedMethod === type;
      
      // –ò—Å–ø–æ–ª—å–∑—É–µ–º –¢–ò–ü –∫–æ—à–µ–ª—å–∫–∞ –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏
      const displayName = type.toUpperCase(); // –ù–∞–ø—Ä–∏–º–µ—Ä: VODAFONE, INSTAPAY
      
      // –ò–∫–æ–Ω–∫–∞ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞
      let icon = 'üí∞';
      if (type.includes('vodafone') || type.includes('vodafon') || type.includes('vf')) icon = 'üì±';
      if (type.includes('instapay') || type.includes('insta') || type.includes('ip')) icon = 'üí≥';
      if (type.includes('orange') || type.includes('orange')) icon = 'üü†';
      if (type.includes('etisalat') || type.includes('etisalat')) icon = 'üü¢';
      
      html += `
        <div class="wallet-type-btn ${isActive ? 'active' : ''}" 
             onclick="selectWalletMethod('${type}')"
             data-type="${type}"
             title="${displayName} (${wallet.availableNumbers.length} available)">
          ${icon} ${displayName}
        </div>
      `;
    }
  });
  
  if (enabledCount === 0) {
    container.innerHTML = `
      <div style="text-align: center; padding: 20px; color: #e74c3c;">
        <div style="font-size: 24px;">‚ö†Ô∏è</div>
        <div style="font-weight: bold; margin: 10px 0;">No active payment methods</div>
        <div style="color: var(--secondary-text); font-size: 14px;">
          All payment methods are currently unavailable. Please try again later.
        </div>
      </div>
    `;
    document.getElementById('depositBtn').disabled = true;
    document.getElementById('depositBtn').innerHTML = 
      '<span style="color: #e74c3c;">‚ö†Ô∏è No payment methods available</span>';
  } else {
    container.innerHTML = html;
    
    // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã–±–∏—Ä–∞–µ–º –ø–µ—Ä–≤—ã–π –¥–æ—Å—Ç—É–ø–Ω—ã–π –º–µ—Ç–æ–¥
    if (!state.selectedMethod && enabledCount > 0) {
      const firstType = Object.keys(state.wallets).find(type => 
        state.wallets[type].enabled && 
        state.wallets[type].availableNumbers && 
        state.wallets[type].availableNumbers.length > 0
      );
      if (firstType) {
        selectWalletMethod(firstType);
      }
    }
  }
  
  log('info', `Rendered ${enabledCount} payment methods (showing type instead of name)`);
}

function selectWalletMethod(type) {
    state.selectedMethod = type;
    document.querySelectorAll('.wallet-type-btn').forEach(btn => btn.classList.remove('active'));
    const selectedBtn = document.querySelector(`.wallet-type-btn[data-type="${type}"]`);
    if (selectedBtn) selectedBtn.classList.add('active');
    
    log('info', `Payment method selected: ${type}`);
}

// ========== –ê–ù–¢–ò–°–ü–ê–ú –£–í–ï–î–û–ú–õ–ï–ù–ò–ï ==========
function showAntispamNotification(minutesLeft, language = 'en') {
    closeAntispamNotification();
    
    const originalBodyOverflow = document.body.style.overflow;
    const originalBodyPosition = document.body.style.position;
    
    const messages = {
        en: {
            title: '‚è∞ Please Wait',
            message: `You need to wait ${minutesLeft} minute${minutesLeft > 1 ? 's' : ''} before making another identical deposit request.`,
            support: 'If the deposit hasn\'t been credited after this time, please contact support.',
            button: 'OK'
        },
        ru: {
            title: '‚è∞ –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, –ø–æ–¥–æ–∂–¥–∏—Ç–µ',
            message: `–í–∞–º –Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å ${minutesLeft} –º–∏–Ω—É—Ç${getRussianMinutesText(minutesLeft)} –ø–µ—Ä–µ–¥ –ø–æ–≤—Ç–æ—Ä–Ω—ã–º –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–º –∑–∞–ø—Ä–æ—Å–æ–º –Ω–∞ –ø–æ–ø–æ–ª–Ω–µ–Ω–∏–µ.`,
            support: '–ï—Å–ª–∏ —Å—Ä–µ–¥—Å—Ç–≤–∞ –Ω–µ –±—ã–ª–∏ –∑–∞—á–∏—Å–ª–µ–Ω—ã –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞, –æ–±—Ä–∞—Ç–∏—Ç–µ—Å—å –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É.',
            button: 'OK'
        },
        fr: {
            title: '‚è∞ Veuillez patienter',
            message: `Vous devez attendre ${minutesLeft} minute${minutesLeft > 1 ? 's' : ''} avant de faire une autre demande de d√©p√¥t identique.`,
            support: 'Si le d√©p√¥t n\'a pas √©t√© cr√©dit√© apr√®s ce d√©lai, veuillez contacter le support.',
            button: 'OK'
        },
        ar: {
            title: '‚è∞ Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ±',
            message: `Ÿäÿ¨ÿ® ÿπŸÑŸäŸÉ ÿßŸÑÿßŸÜÿ™ÿ∏ÿßÿ± ${minutesLeft} ÿØŸÇŸäŸÇÿ©${minutesLeft > 1 ? 'ÿßÿ™' : ''} ŸÇÿ®ŸÑ ÿ™ŸÇÿØŸäŸÖ ÿ∑ŸÑÿ® ÿ•ŸäÿØÿßÿπ ŸÖŸÖÿßÿ´ŸÑ ÿ¢ÿÆÿ±.`,
            support: 'ÿ•ÿ∞ÿß ŸÑŸÖ Ÿäÿ™ŸÖ ÿ•ÿ∂ÿßŸÅÿ© ÿßŸÑÿ£ŸÖŸàÿßŸÑ ÿ®ÿπÿØ Ÿáÿ∞ÿß ÿßŸÑŸàŸÇÿ™ÿå Ÿäÿ±ÿ¨Ÿâ ÿßŸÑÿßÿ™ÿµÿßŸÑ ÿ®ÿßŸÑÿØÿπŸÖ.',
            button: 'ŸÖŸàÿßŸÅŸÇ'
        }
    };
    
    const msg = messages[language] || messages.en;
    
    // –°–æ–∑–¥–∞–µ–º overlay
    const overlay = document.createElement('div');
    overlay.id = 'antispamOverlay';
    overlay.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100vw;
        height: 100vh;
        background: rgba(0, 0, 0, 0.85);
        z-index: 9998;
        backdrop-filter: blur(5px);
    `;
    overlay.onclick = closeAntispamNotification;
    
    // –°–æ–∑–¥–∞–µ–º popup
    const popup = document.createElement('div');
    popup.id = 'antispamNotification';
    popup.style.cssText = `
        position: fixed;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        background: linear-gradient(135deg, #042F28 0%, #0A5C4A 100%);
        color: white;
        padding: 30px;
        border-radius: 20px;
        z-index: 9999;
        width: 90%;
        max-width: 450px;
        border: 3px solid #D0E41E;
        box-shadow: 0 0 40px rgba(208, 228, 30, 0.4);
        backdrop-filter: blur(20px);
        text-align: center;
        animation: fadeIn 0.3s ease-out;
        box-sizing: border-box;
    `;
    
    // –ó–∞–ø–æ–ª–Ω—è–µ–º —Å–æ–¥–µ—Ä–∂–∏–º–æ–µ
    popup.innerHTML = `
        <div style="font-size: 50px; margin-bottom: 20px; color: #D0E41E;">‚è∞</div>
        <div style="font-size: 24px; font-weight: bold; color: #D0E41E; margin-bottom: 15px; word-wrap: break-word;">
            ${msg.title}
        </div>
        <div style="font-size: 16px; margin-bottom: 20px; line-height: 1.5; padding: 0 5px; word-wrap: break-word;">
            ${msg.message}
        </div>
        <div style="
            background: rgba(208, 228, 30, 0.15);
            border-left: 4px solid #D0E41E;
            padding: 15px;
            margin: 20px 0;
            font-size: 14px;
            text-align: left;
            border-radius: 0 10px 10px 0;
            line-height: 1.4;
            word-wrap: break-word;
        ">
            üí° ${msg.support}
        </div>
        <button onclick="closeAntispamNotification()" style="
            background: #D0E41E;
            color: #2c3e50;
            border: none;
            padding: 14px;
            border-radius: 10px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            margin-top: 10px;
            width: 100%;
            transition: all 0.3s;
            box-shadow: 0 4px 15px rgba(208, 228, 30, 0.3);
            box-sizing: border-box;
        ">
            ${msg.button}
        </button>
    `;
    
    // –î–æ–±–∞–≤–ª—è–µ–º –≤ DOM
    document.body.appendChild(overlay);
    document.body.appendChild(popup);
    
    // –ë–ª–æ–∫–∏—Ä—É–µ–º —Å–∫—Ä–æ–ª–ª
    document.body.style.overflow = 'hidden';
    document.body.style.height = '100vh';
    document.body.style.width = '100vw';
    
    // –°–æ—Ö—Ä–∞–Ω—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
    document.body.dataset.originalOverflow = originalBodyOverflow;
    document.body.dataset.originalPosition = originalBodyPosition;
    
    log('info', `Antispam notification shown: ${minutesLeft} minutes`);
}

function closeAntispamNotification() {
    const popup = document.getElementById('antispamNotification');
    const overlay = document.getElementById('antispamOverlay');
    
    if (popup) popup.remove();
    if (overlay) overlay.remove();
    
    // –í–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–µ —Å—Ç–∏–ª–∏
    document.body.style.overflow = document.body.dataset.originalOverflow || '';
    document.body.style.position = document.body.dataset.originalPosition || '';
    document.body.style.height = '';
    document.body.style.width = '';
    
    // –£–¥–∞–ª—è–µ–º data-–∞—Ç—Ä–∏–±—É—Ç—ã
    delete document.body.dataset.originalOverflow;
    delete document.body.dataset.originalPosition;
    
    log('info', 'Antispam notification closed');
}

function getRussianMinutesText(minutes) {
    if (minutes === 1) return '—É';
    if (minutes >= 2 && minutes <= 4) return '—ã';
    return '';
}

// ========== –î–ï–ü–û–ó–ò–¢ ==========
async function processDeposit() {
    if (!state.isLoaded) return;
    
    const account = document.getElementById('account')?.value.trim() || '';
    const amount = document.getElementById('amount')?.value || '';
    const wallet = document.getElementById('wallet')?.value.trim() || '';
    const method = state.selectedMethod;
    
    log('info', 'Processing deposit request', { account, amount, wallet, method });
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–ø–æ–ª–Ω–µ–Ω–Ω–æ—Å—Ç–∏ –ø–æ–ª–µ–π
    if (!account || !amount || !wallet || !method) {
        showNotification(!account || !amount || !wallet ? 'fill_all_fields' : 'select_method', true);
        log('warning', 'Deposit validation failed: missing fields');
        return;
    }
    
    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Å—É–º–º—ã
    if (parseInt(amount) < (state.config?.minDeposit || 100)) {
        showNotification('min_deposit', true, {
            amount: state.config?.minDeposit || 100,
            currency: state.config?.currency || 'EGP'
        });
        log('warning', `Deposit amount too low: ${amount}`);
        return;
    }
        
    state.userAccount = account;
    state.savedWallet = wallet;
    localStorage.setItem('userAccount', account);
    localStorage.setItem('userWallet', wallet);
    
    log('info', 'User data saved to localStorage');
    
    const btn = document.getElementById('depositBtn');
    if (btn) {
        btn.disabled = true;
        btn.innerHTML = '<div class="spinner"></div> ' + translate('deposit.get_wallet_button');
    }
    
    try {
        const url = `${API_URL}?action=check_deposit&account=${encodeURIComponent(account)}&amount=${encodeURIComponent(amount)}&wallet=${encodeURIComponent(wallet)}&type=${encodeURIComponent(method)}&t=${Date.now()}`;
        log('info', `Sending deposit request to: ${url}`);
        
        const response = await fetch(url);
        const result = await response.json();
        
        log('info', 'Deposit response received', result);
        
        if (result.status === 'success') {
            state.currentDeposit = {
                account: account,
                amount: amount,
                wallet: wallet,
                type: method,
                depositWallet: result.wallet
            };
            
            showDepositResult(amount, result.wallet);
            showNotification('deposit_received');
            log('success', 'Deposit processed successfully', { depositWallet: result.wallet });
            
        } else if (result.status === 'error' && result.message?.includes('Please wait')) {
            // –û–ë–†–ê–ë–û–¢–ö–ê –ê–ù–¢–ò–°–ü–ê–ú –û–®–ò–ë–ö–ò
            log('warning', 'Deposit blocked by antispam', result);
            
            const minutesMatch = result.message.match(/(\d+)\s*minute?s?/i);
            const minutesLeft = minutesMatch ? parseInt(minutesMatch[1]) : 3;
            
            showAntispamNotification(minutesLeft, state.currentLanguage);
            
        } else {
            showNotification('server_error', true, { message: result.message });
            log('error', 'Deposit failed on server', result);
        }
    } catch (error) {
        showNotification('network_error', true);
        log('error', 'Network error during deposit', error);
    } finally {
        if (btn) {
            btn.disabled = false;
            btn.textContent = translate('deposit.get_wallet_button');
        }
    }
}

function showDepositResult(amount, wallet) {
    document.getElementById('displayAmount').textContent = `${amount} ${state.config?.currency || 'EGP'}`;
    document.getElementById('depositWallet').textContent = wallet;
    
    document.getElementById('popupOverlay').classList.add('active');
    document.getElementById('depositPopup').classList.add('active');
    
    startDepositTimer();
    log('info', 'Deposit result shown in popup', { amount, wallet });
}

function closeDepositPopup() {
    document.getElementById('popupOverlay').classList.remove('active');
    document.getElementById('depositPopup').classList.remove('active');
    resetDepositForm();
    log('info', 'Deposit popup closed');
}

function startDepositTimer() {
    let timeLeft = 15 * 60;
    const timerElement = document.getElementById('depositTimer');
    
    if (state.depositTimer) clearInterval(state.depositTimer);
    
    log('info', 'Deposit timer started (15 minutes)');
    
    state.depositTimer = setInterval(() => {
        timeLeft--;
        const minutes = Math.floor(timeLeft / 60);
        const seconds = timeLeft % 60;
        timerElement.innerHTML = `‚è∞ <span data-i18n="popup.time_left">${translate('popup.time_left')}</span> ${minutes.toString().padStart(2, '0')}:${seconds.toString().padStart(2, '0')}`;
        
        if (timeLeft < 60) {
            timerElement.classList.add('warning');
        }
        
        if (timeLeft <= 0) {
            clearInterval(state.depositTimer);
            timerElement.textContent = '‚è∞ ' + translate('popup.time_left') + ' 00:00';
            document.getElementById('confirmBtn').disabled = true;
            showNotification('time_expired', true);
            log('warning', 'Deposit timer expired');
        }
    }, 1000);
}

async function confirmDeposit() {
    console.log('=== DEBUG: confirmDeposit –≤—ã–∑–≤–∞–Ω–∞ ===');

    if (!state.currentDeposit) {
        console.log('ERROR: –ù–µ—Ç —Ç–µ–∫—É—â–µ–≥–æ –¥–µ–ø–æ–∑–∏—Ç–∞');
        showNotification('no_deposit', true);
        return;
    }

    console.log('–î–∞–Ω–Ω—ã–µ –¥–µ–ø–æ–∑–∏—Ç–∞:', state.currentDeposit);
    
    const confirmBtn = document.getElementById('confirmBtn');
    if (confirmBtn) {
        confirmBtn.disabled = true;
        confirmBtn.textContent = translate('popup.confirm_button');
    }
    
    log('info', 'Confirming deposit', state.currentDeposit);
    
    try {
        const params = new URLSearchParams({
            action: 'confirm_deposit',
            account: state.currentDeposit.account,
            amount: state.currentDeposit.amount,
            wallet: state.currentDeposit.wallet,
            depositWallet: state.currentDeposit.depositWallet,
            type: state.currentDeposit.type,
            t: Date.now()
        });
        
        const confirmUrl = `${API_URL}?${params.toString()}`;
        log('info', `Sending confirmation to: ${confirmUrl}`);
        
        const response = await fetch(confirmUrl);
        const result = await response.json();
        
        log('info', 'Confirmation response received', result);
        
        if (result.status === 'success') {
            showNotification('confirmed');
            
            const timerElement = document.getElementById('depositTimer');
            if (timerElement) {
                timerElement.textContent = '‚úÖ ' + translate('popup.confirm_button');
                timerElement.className = 'timer';
            }
            
            log('success', 'Deposit confirmed successfully');
            
            setTimeout(() => {
                closeDepositPopup();
            }, 2000);
            
        } else {
            showNotification('confirmation_failed', true, { message: result.message });
            if (confirmBtn) confirmBtn.disabled = false;
            log('error', 'Deposit confirmation failed', result);
        }
        
    } catch (error) {
        console.error('‚ùå Confirmation error:', error);
        showNotification('network_error', true);
        if (confirmBtn) confirmBtn.disabled = false;
        log('error', 'Network error during confirmation', error);
    }
}

function resetDepositForm() {
    document.getElementById('amount').value = '';
    state.selectedMethod = null;
    document.querySelectorAll('.wallet-type-btn').forEach(btn => btn.classList.remove('active'));
    
    if (state.depositTimer) {
        clearInterval(state.depositTimer);
        log('info', 'Deposit timer cleared');
    }
    state.currentDeposit = null;
    
    document.getElementById('confirmBtn').disabled = false;
    document.getElementById('confirmBtn').textContent = translate('popup.confirm_button');
    
    const timerElement = document.getElementById('depositTimer');
    if (timerElement) {
        timerElement.textContent = '‚è∞ ' + translate('popup.time_left') + ' 15:00';
        timerElement.className = 'timer';
    }
    
    log('info', 'Deposit form reset');
}

function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        showNotification('copied');
        log('info', `Text copied to clipboard: ${text}`);
    });
}

// ========== –í–´–í–û–î ==========
async function processWithdrawal() {
    if (!state.isLoaded) return;
    
    const account = document.getElementById('withdrawAccount')?.value.trim() || '';
    const amount = document.getElementById('withdrawAmount')?.value || '';
    const wallet = document.getElementById('withdrawWallet')?.value.trim() || '';
    const code = document.getElementById('withdrawCode')?.value.trim() || '';
    
    log('info', 'Processing withdrawal request', { account, amount, wallet, code });
    
    if (!account || !amount || !wallet || !code) {
        showNotification('fill_all_fields', true);
        log('warning', 'Withdrawal validation failed: missing fields');
        return;
    }
    
    if (parseInt(amount) < (state.config?.minWithdrawal || 300)) {
        showNotification('min_withdrawal', true, {
            amount: state.config?.minWithdrawal || 300,
            currency: state.config?.currency || 'EGP'
        });
        log('warning', `Withdrawal amount too low: ${amount}`);
        return;
    }
    
    if (code.length < 4) {
        showNotification('code_length', true);
        log('warning', `Withdrawal code too short: ${code.length} chars`);
        return;
    }
    
    state.savedWallet = wallet;
    localStorage.setItem('userWallet', wallet);
    
    log('info', 'Wallet saved to localStorage');
    
    const withdrawBtn = document.getElementById('withdrawBtn');
    const originalText = withdrawBtn?.textContent || translate('withdrawal.request_button');
    
    if (withdrawBtn) {
        withdrawBtn.disabled = true;
        withdrawBtn.textContent = translate('withdrawal.request_button');
    }
    
    try {
        const params = new URLSearchParams({
            action: 'withdraw',
            account: account,
            amount: amount,
            wallet: wallet,
            code: code,
            t: Date.now()
        });
        
        const url = `${API_URL}?${params.toString()}`;
        log('info', `Sending withdrawal request to: ${url}`);
        
        const response = await fetch(url);
        const result = await response.json();
        
        log('info', 'Withdrawal response received', result);
        
        if (result.status === 'success') {
            showNotification('withdrawal_submitted');
            
            document.getElementById('withdrawAmount').value = '';
            document.getElementById('withdrawCode').value = '';
            
            log('success', 'Withdrawal request submitted successfully');
            
        } else {
            showNotification(`‚ùå ${result.message || 'Withdrawal failed'}`, true);
            log('error', 'Withdrawal failed on server', result);
        }
        
    } catch (error) {
        showNotification('‚ùå Network error. Please try again.', true);
        log('error', 'Network error during withdrawal', error);
    } finally {
        if (withdrawBtn) {
            withdrawBtn.disabled = false;
            withdrawBtn.textContent = originalText;
        }
    }
}
    </script>
</body>
</html>
