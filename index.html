<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Payment System</title>
    <style>
        /* –°—Ç–∏–ª–∏ –æ—Å—Ç–∞—é—Ç—Å—è —Ç–µ–º–∏ –∂–µ */
        :root {
            --primary-bg: linear-gradient(135deg, #042F28 0%, #0A5C4A 100%);
            --accent-color: #D0E41E;
            --text-color: white;
            --secondary-text: #ccc;
            --loading-green: #0A5C4A;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Arial', sans-serif;
        }

        body {
            background: var(--primary-bg);
            color: var(--text-color);
            min-height: 100vh;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        /* –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù */
        #loadingScreen {
            width: 100%;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            text-align: center;
        }

        .loading-container {
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .logo-spin {
            font-size: 64px;
            font-weight: 900;
            margin-bottom: 30px;
            display: flex;
            gap: 5px;
            justify-content: center;
            align-items: center;
        }

        .spin-letter {
            font-size: 64px;
            font-weight: 900;
            color: white;
            display: inline-block;
            position: relative;
        }

        .spin-letter:nth-child(1) { animation: spinLetter1 2s ease-in-out infinite; }
        .spin-letter:nth-child(2) { animation: spinLetter2 2s ease-in-out infinite 0.2s; }
        .spin-letter:nth-child(3) { animation: spinLetter3 2s ease-in-out infinite 0.4s; }
        .spin-letter:nth-child(4) { animation: spinLetter4 2s ease-in-out infinite 0.6s; }

        @keyframes spinLetter1 {
            0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
            50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
        }

        @keyframes spinLetter2 {
            0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
            50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
        }

        @keyframes spinLetter3 {
            0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
            50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
        }

        @keyframes spinLetter4 {
            0%, 40%, 60%, 100% { transform: translateY(0) rotateX(0); opacity: 1; }
            50% { transform: translateY(-30px) rotateX(90deg); opacity: 0; }
        }

        .better-text {
            font-size: 64px;
            font-weight: 900;
            color: var(--loading-green);
            display: inline-block;
            margin-left: 10px;
        }

        .loading-subtitle {
            margin-top: 20px;
            color: var(--secondary-text);
            font-size: 16px;
        }

        /* –°–ï–†–í–ò–°–ù–´–ô –†–ï–ñ–ò–ú */
        #serviceModeScreen {
            display: none;
            max-width: 600px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 20px;
            padding: 40px;
            border: 2px solid var(--accent-color);
            backdrop-filter: blur(20px);
            box-shadow: 0 20px 50px rgba(0,0,0,0.5);
            text-align: center;
            animation: fadeIn 0.5s ease;
        }

        .service-icon {
            font-size: 80px;
            margin-bottom: 20px;
            color: var(--accent-color);
            animation: pulse 2s infinite;
        }

        .service-title {
            font-size: 32px;
            font-weight: bold;
            color: var(--accent-color);
            margin-bottom: 15px;
            line-height: 1.3;
        }

        .service-subtitle {
            font-size: 18px;
            color: var(--secondary-text);
            margin-bottom: 30px;
            line-height: 1.5;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; transform: scale(1); }
            50% { opacity: 0.8; transform: scale(1.05); }
        }

        /* –ú–û–ë–ò–õ–¨–ù–ê–Ø –ê–î–ê–ü–¢–ê–¶–ò–Ø */
        @media (max-width: 768px) {
            .logo-spin, .spin-letter, .better-text {
                font-size: 48px;
            }
            
            #serviceModeScreen {
                padding: 30px 20px;
                margin: 20px;
            }
            
            .service-icon {
                font-size: 60px;
            }
            
            .service-title {
                font-size: 26px;
            }
        }

        @media (max-width: 480px) {
            .logo-spin, .spin-letter, .better-text {
                font-size: 36px;
            }
            
            #serviceModeScreen {
                padding: 25px 15px;
            }
            
            .service-icon {
                font-size: 50px;
            }
            
            .service-title {
                font-size: 22px;
            }
            
            .service-subtitle {
                font-size: 16px;
            }
        }
    </style>
</head>
<body>
    <!-- –≠–∫—Ä–∞–Ω –∑–∞–≥—Ä—É–∑–∫–∏ -->
    <div id="loadingScreen">
        <div class="loading-container">
            <div class="logo-spin">
                <span class="spin-letter">S</span>
                <span class="spin-letter">P</span>
                <span class="spin-letter">I</span>
                <span class="spin-letter">N</span>
                <span class="better-text">BETTER</span>
            </div>
            <div class="loading-subtitle" id="loadingText">Checking system status...</div>
        </div>
    </div>

    <!-- –°–µ—Ä–≤–∏—Å–Ω—ã–π —Ä–µ–∂–∏–º -->
    <div id="serviceModeScreen">
        <div class="service-icon">üîß</div>
        <div class="service-title" id="serviceTitle">Service temporarily unavailable</div>
        <div class="service-subtitle" id="serviceSubtitle">We apologize for any inconvenience</div>
    </div>

    <script>
        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ—Ç –∂–µ URL —á—Ç–æ –∏ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü–µ
        const API_URL = 'https://script.google.com/macros/s/AKfycbzsrKx2P-G6XsaqpWb6YctaOIG8WslO-a9qNSQhnOiPD8S30roYmXCJqYL3TdiSAox4/exec';
        
        // –û–ø—Ä–µ–¥–µ–ª—è–µ–º —è–∑—ã–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        function getBrowserLanguage() {
            const browserLang = navigator.language || navigator.userLanguage;
            if (browserLang.startsWith('ru')) return 'ru';
            if (browserLang.startsWith('fr')) return 'fr';
            if (browserLang.startsWith('ar')) return 'ar';
            return 'en';
        }

        // –ü–µ—Ä–µ–≤–æ–¥—ã –¥–ª—è —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ —Ä–µ–∂–∏–º–∞
        const serviceMessages = {
            en: {
                title: 'Service temporarily unavailable',
                subtitle: 'We apologize for any inconvenience'
            },
            ru: {
                title: '–°–µ—Ä–≤–∏—Å –≤—Ä–µ–º–µ–Ω–Ω–æ –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω',
                subtitle: '–ü—Ä–∏–Ω–æ—Å–∏–º –∏–∑–≤–∏–Ω–µ–Ω–∏—è –∑–∞ –¥–æ—Å—Ç–∞–≤–ª–µ–Ω–Ω—ã–µ –Ω–µ—É–¥–æ–±—Å—Ç–≤–∞'
            },
            fr: {
                title: 'Service temporairement indisponible',
                subtitle: 'Nous nous excusons pour le d√©rangement'
            },
            ar: {
                title: 'ÿßŸÑÿÆÿØŸÖÿ© ÿ∫Ÿäÿ± ŸÖÿ™ŸàŸÅÿ±ÿ© ŸÖÿ§ŸÇÿ™ÿßŸã',
                subtitle: 'ŸÜÿπÿ™ÿ∞ÿ± ÿπŸÜ ÿ£Ÿä ÿ•ÿ≤ÿπÿßÿ¨'
            }
        };

        async function checkServiceStatus() {
            // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º —Å—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏
            document.getElementById('loadingText').textContent = 'Checking system status...';
            
            try {
                const url = `${API_URL}?action=get_config&t=${Date.now()}`;
                console.log('Fetching config from:', url);
                
                // –î–µ–ª–∞–µ–º –û–ë–´–ß–ù–´–ô fetch –∑–∞–ø—Ä–æ—Å (–±–µ–∑ mode: 'no-cors')
                const response = await fetch(url);
                console.log('Response status:', response.status, response.ok);
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º, —É—Å–ø–µ—à–µ–Ω –ª–∏ HTTP-–æ—Ç–≤–µ—Ç (—Å—Ç–∞—Ç—É—Å 200-299)
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                // –ü–∞—Ä—Å–∏–º JSON –æ—Ç–≤–µ—Ç
                const result = await response.json();
                console.log('API Response:', result);
                
                // –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û: –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç—Ä—É–∫—Ç—É—Ä—É –æ—Ç–≤–µ—Ç–∞
                if (result.status === 'success' && result.config) {
                    // –°–ò–°–¢–ï–ú–ê –ê–ö–¢–ò–í–ù–ê
                    if (result.config.isActive !== false) {
                        console.log('System is ACTIVE. Redirecting to main.html...');
                        window.location.href = 'main.html';
                        // –ö–æ—Ä–æ—Ç–∫–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –≤–æ—Å–ø—Ä–∏—è—Ç–∏—è
                        /*setTimeout(() => {
                            window.location.href = 'main.html';
                        }, 800);*/
                    } 
                    // –°–ò–°–¢–ï–ú–ê –í –°–ï–†–í–ò–°–ù–û–ú –†–ï–ñ–ò–ú–ï
                    else {
                        console.log('System is INACTIVE (maintenance). Showing service mode.');
                        showServiceMode();
                    }
                } else {
                    // –û—Ç–≤–µ—Ç API –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
                    console.error('Invalid API response structure:', result);
                    showServiceMode(); // –ë–µ–∑–æ–ø–∞—Å–Ω—ã–π —Ä–µ–∂–∏–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é
                }
                
            } catch (error) {
                // –õ–Æ–ë–ê–Ø –û–®–ò–ë–ö–ê (—Å–µ—Ç—å, –ø–∞—Ä—Å–∏–Ω–≥ JSON) ‚Üí —Å–µ—Ä–≤–∏—Å–Ω—ã–π —Ä–µ–∂–∏–º
                console.error('Error checking service status:', error);
                showServiceMode();
            }
        }
        
        // –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
        /*checkServiceStatus().then(result => {
            if (result.status === 'success' && result.config.isActive !== false) {
                window.location.href = 'main.html';
            } else {
                showServiceMode();
            }
        });*/

        function showServiceMode() {
            const lang = getBrowserLanguage();
            const messages = serviceMessages[lang] || serviceMessages.en;
            
            document.getElementById('loadingScreen').style.display = 'none';
            document.getElementById('serviceModeScreen').style.display = 'block';
            document.getElementById('serviceTitle').textContent = messages.title;
            document.getElementById('serviceSubtitle').textContent = messages.subtitle;
        }

        // –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –ø—Ä–æ–≤–µ—Ä—è–µ–º —Å—Ç–∞—Ç—É—Å
        document.addEventListener('DOMContentLoaded', function() {
            checkServiceStatus();
            // –ù–µ–±–æ–ª—å—à–∞—è –∑–∞–¥–µ—Ä–∂–∫–∞ –¥–ª—è –ø–æ–∫–∞–∑–∞ –∞–Ω–∏–º–∞—Ü–∏–∏
            /*setTimeout(() => {
                checkServiceStatus();
            }, 1500);*/
        });
    </script>
</body>
</html>
